import{_ as a,r as t,o as e,c as o,b as n,d as p,a as c,e as l}from"./app.7c042103.js";var i="/assets/java.eb6aa7a6.png",r="/assets/classloader.f58028f7.png",d="/assets/test1.705d14db.png",u="/assets/test2.57b38d1b.png",k="/assets/test3.70c9dbe0.png",v="/assets/test4.9293f528.png",g="/assets/jvm.35640740.png",m="/assets/memory1.7e1f0cff.png",b="/assets/jconsole.548663e1.png",h="/assets/jubin.40cf6487.png",f="/assets/zhijiezhizheng.296f254b.png",y="/assets/demo1.3b4f25e9.png",S="/assets/demo2.b893d021.png",w="/assets/demo3.72622507.png",C="/assets/result1.423dda79.png",j="/assets/164a85bd8307d805.31b160b3.png",M="/assets/164a85bd831e2005.47ed3c5f.png",x="/assets/jvm1.a9361bf5.png",E="/assets/16502c7b8a61ea51.a34554b4.png",O="/assets/16502c7bd1ebf8c4.513f166c.png",J="/assets/16502c7b88cda952.96352302.png",_="/assets/16502c7b8a60fa35.0c656cba.png",q="/assets/16502c7bb00da43d.8a5fce4b.png",L="/assets/1691ed081995f262.e273ac4d.png",P="/assets/16502c7bb5454a60.f63907e5.png";const N={},G=c('<h2 id="jvm-jre-jdk-\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#jvm-jre-jdk-\u5173\u7CFB" aria-hidden="true">#</a> JVM-&gt;JRE-&gt;JDK \u5173\u7CFB</h2><p><img src="'+i+'" alt="\u5173\u7CFB\u56FE"></p><ul><li><p><code>JDK</code>(Java Development Kit) \u662F <code>Java</code> \u8BED\u8A00\u7684\u8F6F\u4EF6\u5F00\u53D1\u5DE5\u5177\u5305\uFF08<code>SDK</code>\uFF09\u3002<code>JDK</code> \u7269\u7406\u5B58\u5728\uFF0C\u662F <code>programming tools</code>\u3001<code>JRE</code> \u548C <code>JVM</code> \u7684\u4E00\u4E2A\u96C6\u5408\u3002</p></li><li><p><code>JRE</code>\uFF08Java Runtime Environment\uFF09<code>Java</code> \u8FD0\u884C\u65F6\u73AF\u5883\uFF0C<code>JRE</code> \u662F\u7269\u7406\u5B58\u5728\u7684\uFF0C\u4E3B\u8981\u7531<code>Java API</code> \u548C <code>JVM</code> \u7EC4\u6210\uFF0C\u63D0\u4F9B\u4E86\u7528\u4E8E\u6267\u884C <code>java</code> \u5E94\u7528\u7A0B\u5E8F\u6700\u4F4E\u8981\u6C42\u7684\u73AF\u5883\u3002</p></li><li><p><code>JVM</code>\u662F\u4E00\u79CD\u7528\u4E8E\u8BA1\u7B97\u8BBE\u5907\u7684\u89C4\u8303\uFF0C\u5B83\u662F\u4E00\u4E2A\u865A\u6784\u7684\u8BA1\u7B97\u673A\u7684\u8F6F\u4EF6\u5B9E\u73B0\uFF0C\u7B80\u5355\u7684\u8BF4\uFF0C<code>JVM</code>\u662F\u8FD0\u884C<code>byte code</code>\u5B57\u8282\u7801\u7A0B\u5E8F\u7684\u4E00\u4E2A\u5BB9\u5668\u3002</p></li></ul><h3 id="jvm\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#jvm\u7279\u70B9" aria-hidden="true">#</a> JVM\u7279\u70B9</h3><ul><li><p><strong>\u57FA\u4E8E\u5806\u6808\u7684\u865A\u62DF\u673A</strong>\uFF1A\u6700\u6D41\u884C\u7684\u8BA1\u7B97\u673A\u4F53\u7CFB\u7ED3\u6784\uFF0C\u5982\u82F1\u7279\u5C14 X86 \u67B6\u6784\u548C ARM \u67B6\u6784\u4E0A\u8FD0\u884C\u57FA\u4E8E \u5BC4\u5B58\u5668\u3002\u6BD4\u5982\uFF0C\u5B89\u5353\u7684 Davilk \u865A\u62DF\u673A\u5C31\u662F\u57FA\u4E8E \u5BC4\u5B58\u5668 \u7ED3\u6784\uFF0C\u800C JVM \u662F\u57FA\u4E8E\u6808\u7ED3\u6784\u7684\u3002</p></li><li><p><strong>\u7B26\u53F7\u5F15\u7528</strong> \uFF1A\u9664\u4E86\u57FA\u672C\u7C7B\u578B\u4EE5\u5916\u7684\u6570\u636E \uFF08\u7C7B\u548C\u63A5\u53E3\uFF09 \u90FD\u662F\u901A\u8FC7\u7B26\u53F7\u6765\u5F15\u7528\uFF0C\u800C\u4E0D\u662F\u901A\u8FC7\u663E\u5F0F\u5730\u4F7F\u7528\u5185\u5B58\u5730\u5740\u6765\u5F15\u7528\u3002</p></li><li><p><strong>\u5783\u573E\u6536\u96C6</strong> \uFF1A\u4E00\u4E2A\u7C7B\u7684\u5B9E\u4F8B\u662F\u7531\u7528\u6237\u7A0B\u5E8F\u521B\u5EFA\u548C\u5783\u573E\u56DE\u6536\u81EA\u52A8\u9500\u6BC1\u3002</p></li><li><p><strong>\u7F51\u7EDC\u5B57\u8282\u987A\u5E8F</strong> \uFF1AJava class\u6587\u4EF6\u7528\u7F51\u7EDC\u5B57\u8282\u7801\u987A\u5E8F\u6765\u8FDB\u884C\u5B58\u50A8\uFF0C\u4FDD\u8BC1\u4E86\u5C0F\u7AEF\u7684Intel x86\u67B6\u6784\u548C\u5927\u7AEF\u7684RISC\u7CFB\u5217\u7684\u67B6\u6784\u4E4B\u95F4\u7684\u65E0\u5173\u6027\u3002</p></li></ul><h2 id="\u7C7B\u52A0\u8F7D\u5668" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u52A0\u8F7D\u5668" aria-hidden="true">#</a> \u7C7B\u52A0\u8F7D\u5668</h2><p><img src="'+r+`" alt=""></p><h3 id="\u5173\u7CFB" tabindex="-1"><a class="header-anchor" href="#\u5173\u7CFB" aria-hidden="true">#</a> \u5173\u7CFB</h3><ol><li><p><code>Bootstrap Classloader</code> \u662F\u5728Java\u865A\u62DF\u673A\u542F\u52A8\u540E\u521D\u59CB\u5316\u7684\u3002</p></li><li><p><code>Bootstrap Classloader</code> \u8D1F\u8D23\u52A0\u8F7D <code>ExtClassLoader</code>\uFF0C\u5E76\u4E14\u5C06 <code>E</code>xtClassLoader<code>\u7684\u7236\u52A0\u8F7D\u5668\u8BBE\u7F6E\u4E3A </code>Bootstrap Classloader\`</p></li><li><p><code>Bootstrap Classloader</code> \u52A0\u8F7D\u5B8C <code>ExtClassLoader</code> \u540E\uFF0C\u5C31\u4F1A\u52A0\u8F7D <code>AppClassLoader</code>\uFF0C\u5E76\u4E14\u5C06 <code>AppClassLoader</code> \u7684\u7236\u52A0\u8F7D\u5668\u6307\u5B9A\u4E3A <code>ExtClassLoader</code>\u3002</p></li></ol><h3 id="\u53CC\u4EB2\u59D4\u6258" tabindex="-1"><a class="header-anchor" href="#\u53CC\u4EB2\u59D4\u6258" aria-hidden="true">#</a> \u53CC\u4EB2\u59D4\u6258</h3><p><code>Java</code>\u4E2D<code>ClassLoader</code>\u7684\u52A0\u8F7D\u91C7\u7528\u4E86<strong>\u53CC\u4EB2\u59D4\u6258\u673A\u5236</strong>\uFF0C\u91C7\u7528<strong>\u53CC\u4EB2\u59D4\u6258\u673A\u5236</strong>\u52A0\u8F7D\u7C7B\u7684\u65F6\u5019\u91C7\u7528\u5982\u4E0B\u7684\u51E0\u4E2A\u6B65\u9AA4\uFF1A</p><ol><li><p>\u5F53\u524D<code>ClassLoader</code>\u9996\u5148\u4ECE\u81EA\u5DF1\u5DF2\u7ECF\u52A0\u8F7D\u7684\u7C7B\u4E2D\u67E5\u8BE2\u662F\u5426\u6B64\u7C7B\u5DF2\u7ECF\u52A0\u8F7D\uFF0C\u5982\u679C\u5DF2\u7ECF\u52A0\u8F7D\u5219\u76F4\u63A5\u8FD4\u56DE\u539F\u6765\u5DF2\u7ECF\u52A0\u8F7D\u7684\u7C7B\u3002</p></li><li><p>\u5F53\u524D<code>ClassLoader</code>\u7684\u7F13\u5B58\u4E2D\u6CA1\u6709\u627E\u5230\u88AB\u52A0\u8F7D\u7684\u7C7B\u7684\u65F6\u5019\uFF0C\u59D4\u6258\u7236\u7C7B\u52A0\u8F7D\u5668\u53BB\u52A0\u8F7D\uFF0C\u7236\u7C7B\u52A0\u8F7D\u5668\u91C7\u7528\u540C\u6837\u7684\u7B56\u7565\uFF0C\u9996\u5148\u67E5\u770B\u81EA\u5DF1\u7684\u7F13\u5B58\uFF0C\u7136\u540E\u59D4\u6258\u7236\u7C7B\u7684\u7236\u7C7B\u53BB\u52A0\u8F7D\uFF0C\u4E00\u76F4\u5230<code>Bootstrap ClassLoader</code>\u3002</p></li><li><p>\u5F53\u6240\u6709\u7684\u7236\u7C7B\u52A0\u8F7D\u5668\u90FD\u6CA1\u6709\u52A0\u8F7D\u7684\u65F6\u5019\uFF0C\u518D\u7531\u5F53\u524D\u7684\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7D\uFF0C\u5E76\u5C06\u5176\u653E\u5165\u5B83\u81EA\u5DF1\u7684\u7F13\u5B58\u4E2D\uFF0C\u4EE5\u4FBF\u4E0B\u6B21\u6709\u52A0\u8F7D\u8BF7\u6C42\u7684\u65F6\u5019\u76F4\u63A5\u8FD4\u56DE\u3002</p></li></ol><blockquote><p>\u53CC\u4EB2\u59D4\u6258\u673A\u5236\u7684\u6838\u5FC3\u601D\u60F3\u5206\u4E3A\u4E24\u4E2A\u6B65\u9AA4\u3002\u5176\u4E00\uFF0C\u81EA\u5E95\u5411\u4E0A\u68C0\u67E5\u7C7B\u662F\u5426\u5DF2\u7ECF\u52A0\u8F7D\uFF1B\u5176\u4E8C\uFF0C\u81EA\u9876\u5411\u4E0B\u5C1D\u8BD5\u52A0\u8F7D\u7C7B\u3002</p></blockquote><h3 id="\u7279\u70B9" tabindex="-1"><a class="header-anchor" href="#\u7279\u70B9" aria-hidden="true">#</a> \u7279\u70B9</h3><ul><li><p><strong>\u5C42\u7EA7\u7ED3\u6784</strong>\uFF1AJava\u91CC\u7684\u7C7B\u88C5\u8F7D\u5668\u88AB\u7EC4\u7EC7\u6210\u4E86\u6709\u7236\u5B50\u5173\u7CFB\u7684\u5C42\u7EA7\u7ED3\u6784\u3002Bootstrap\u7C7B\u88C5\u8F7D\u5668\u662F\u6240\u6709\u88C5\u8F7D\u5668\u7684\u7236\u4EB2\u3002</p></li><li><p><strong>\u4EE3\u7406\u6A21\u5F0F</strong>\uFF1A \u57FA\u4E8E\u5C42\u7EA7\u7ED3\u6784\uFF0C\u7C7B\u7684\u4EE3\u7406\u53EF\u4EE5\u5728\u88C5\u8F7D\u5668\u4E4B\u95F4\u8FDB\u884C\u4EE3\u7406\u3002\u5F53\u88C5\u8F7D\u5668\u88C5\u8F7D\u4E00\u4E2A\u7C7B\u65F6\uFF0C\u9996\u5148\u4F1A\u68C0\u67E5\u5B83\u5728\u7236\u88C5\u8F7D\u5668\u4E2D\u662F\u5426\u8FDB\u884C\u4E86\u88C5\u8F7D\u3002\u5982\u679C\u4E0A\u5C42\u88C5\u8F7D\u5668\u5DF2\u7ECF\u88C5\u8F7D\u4E86\u8FD9\u4E2A\u7C7B\uFF0C\u8FD9\u4E2A\u7C7B\u4F1A\u88AB\u76F4\u63A5\u4F7F\u7528\u3002\u53CD\u4E4B\uFF0C\u7C7B\u88C5\u8F7D\u5668\u4F1A\u8BF7\u6C42\u88C5\u8F7D\u8FD9\u4E2A\u7C7B</p></li><li><p><strong>\u53EF\u89C1\u6027\u9650\u5236</strong>\uFF1A\u4E00\u4E2A\u5B50\u88C5\u8F7D\u5668\u53EF\u4EE5\u67E5\u627E\u7236\u88C5\u8F7D\u5668\u4E2D\u7684\u7C7B\uFF0C\u4F46\u662F\u4E00\u4E2A\u7236\u88C5\u8F7D\u5668\u4E0D\u80FD\u67E5\u627E\u5B50\u88C5\u8F7D\u5668\u91CC\u7684\u7C7B\u3002</p></li><li><p><strong>\u4E0D\u5141\u8BB8\u5378\u8F7D</strong>\uFF1A\u7C7B\u88C5\u8F7D\u5668\u53EF\u4EE5\u88C5\u8F7D\u4E00\u4E2A\u7C7B\u4F46\u662F\u4E0D\u53EF\u4EE5\u5378\u8F7D\u5B83\uFF0C\u4E0D\u8FC7\u53EF\u4EE5\u5220\u9664\u5F53\u524D\u7684\u7C7B\u88C5\u8F7D\u5668\uFF0C\u7136\u540E\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u7C7B\u88C5\u8F7D\u5668\u88C5\u8F7D\u3002</p></li></ul><h3 id="\u7C7B\u7684\u52A8\u6001\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u7684\u52A8\u6001\u52A0\u8F7D" aria-hidden="true">#</a> \u7C7B\u7684\u52A8\u6001\u52A0\u8F7D</h3><p>\u7C7B\u7684\u51E0\u79CD\u52A0\u8F7D\u65B9\u5F0F</p><ul><li>\u901A\u8FC7<strong>\u547D\u4EE4\u884C</strong>\u542F\u52A8\u65F6\u7531<code>JVM</code>\u521D\u59CB\u5316\u52A0\u8F7D\uFF1B</li><li>\u901A\u8FC7<code>Class.forName()</code>\u65B9\u6CD5\u52A8\u6001\u52A0\u8F7D\uFF1B</li><li>\u901A\u8FC7<code>ClassLoader.loadClass()</code>\u65B9\u6CD5\u52A8\u6001\u52A0\u8F7D\u3002 <strong>Class.forName()\u548CClassLoader.loadClass()</strong></li><li><strong>Class.forName()</strong>\uFF1A\u628A\u7C7B\u7684<code>.class</code>\u6587\u4EF6\u52A0\u8F7D\u5230<code>JVM</code>\u4E2D\uFF0C\u5BF9\u7C7B\u8FDB\u884C\u89E3\u91CA\u7684\u540C\u65F6\u6267\u884C\u7C7B\u4E2D\u7684<code>static</code><strong>\u9759\u6001\u4EE3\u7801\u5757</strong>\uFF1B</li><li><strong>ClassLoader.loadClass()</strong>\uFF1A\u53EA\u662F\u628A<code>.class</code>\u6587\u4EF6\u52A0\u8F7D\u5230<code>JVM</code>\u4E2D\uFF0C\u4E0D\u4F1A\u6267\u884C<code>static</code>\u4EE3\u7801\u5757\u4E2D\u7684\u5185\u5BB9\uFF0C\u53EA\u6709\u5728<code>newInstance</code>\u624D\u4F1A\u53BB\u6267\u884C\u3002</li></ul><h3 id="\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</h3><ol><li>\u5B9A\u4E49\u5F85\u52A0\u8F7D\u7684\u76EE\u6807\u7C7BParent.java\u548CChildren.java\u3002</li></ol><p>Parent.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>ostenant<span class="token punctuation">.</span>jdk8<span class="token punctuation">.</span>learning<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>classloader<span class="token punctuation">.</span>custom</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">String</span> CLASS_NAME<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">String</span> CLASS_LOADER_NAME<span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token class-name">String</span> instanceID<span class="token punctuation">;</span>

	<span class="token comment">// 1.\u5148\u6267\u884C\u9759\u6001\u53D8\u91CF\u548C\u9759\u6001\u4EE3\u7801\u5757\uFF08\u53EA\u5728\u7C7B\u52A0\u8F7D\u671F\u95F4\u6267\u884C\u4E00\u6B21\uFF09</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        CLASS_NAME <span class="token operator">=</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        CLASS_LOADER_NAME <span class="token operator">=</span> <span class="token class-name">Parent</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step a: &quot;</span> <span class="token operator">+</span> CLASS_NAME <span class="token operator">+</span> <span class="token string">&quot; is loaded by &quot;</span> <span class="token operator">+</span> CLASS_LOADER_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 2.\u7136\u540E\u6267\u884C\u53D8\u91CF\u548C\u666E\u901A\u4EE3\u7801\u5757\uFF08\u6BCF\u6B21\u521B\u5EFA\u5B9E\u4F8B\u90FD\u4F1A\u6267\u884C\uFF09</span>
    <span class="token punctuation">{</span>
        instanceID <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step c: Parent instance is created: &quot;</span> <span class="token operator">+</span> CLASS_LOADER_NAME <span class="token operator">+</span> <span class="token string">&quot; -&gt; &quot;</span> <span class="token operator">+</span> instanceID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3.\u7136\u540E\u6267\u884C\u6784\u9020\u65B9\u6CD5</span>
    <span class="token keyword">public</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step d: Parent instance\uFF1A&quot;</span> <span class="token operator">+</span> instanceID <span class="token operator">+</span> <span class="token string">&quot;, constructor is invoked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;My first class loader...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Children.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>ostenant<span class="token punctuation">.</span>jdk8<span class="token punctuation">.</span>learning<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>classloader<span class="token punctuation">.</span>custom</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Children</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        CLASS_NAME <span class="token operator">=</span> <span class="token class-name">Children</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        CLASS_LOADER_NAME <span class="token operator">=</span> <span class="token class-name">Children</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step b: &quot;</span> <span class="token operator">+</span> CLASS_NAME <span class="token operator">+</span> <span class="token string">&quot; is loaded by &quot;</span> <span class="token operator">+</span> CLASS_LOADER_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token punctuation">{</span>
        instanceID <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step e: Children instance is created: &quot;</span> <span class="token operator">+</span> CLASS_LOADER_NAME <span class="token operator">+</span> <span class="token string">&quot; -&gt; &quot;</span> <span class="token operator">+</span> instanceID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Children</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Step f: Children instance\uFF1A&quot;</span> <span class="token operator">+</span> instanceID <span class="token operator">+</span> <span class="token string">&quot;, constructor is invoked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;My first class loader...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u5B9E\u73B0\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668CustomClassLoader</li></ol><p>CustomClassLoader.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomClassLoader</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> classPath<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CustomClassLoader</span><span class="token punctuation">(</span><span class="token class-name">String</span> classPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>classPath <span class="token operator">=</span> classPath<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u53EF\u7701\u7565</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> <span class="token function">loadClassData</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">defineClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">loadClassData</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// package -&gt; file folder</span>
            name <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>classPath <span class="token operator">+</span> <span class="token string">&quot;//&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;.class&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">2048</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u6D4B\u8BD5\u7C7B\u52A0\u8F7D\u5668\u7684\u52A0\u8F7D\u8FC7\u7A0B</li></ol><p>CustomerClassLoaderTester.java</p><pre><code>- \u6D4B\u8BD5\u7A0B\u5E8F\u542F\u52A8\u65F6\uFF0C\u9010\u4E00\u62F7\u8D1D\u5E76\u52A0\u8F7D\u5F85\u52A0\u8F7D\u7684\u76EE\u6807\u7C7B\u6E90\u6587\u4EF6\u3002
</code></pre><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CHILDREN_SOURCE_CODE_NAME <span class="token operator">=</span> SOURCE_CODE_LOCATION <span class="token operator">+</span> <span class="token string">&quot;Children.java&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PARENT_SOURCE_CODE_NAME <span class="token operator">=</span> SOURCE_CODE_LOCATION <span class="token operator">+</span> <span class="token string">&quot;Parent.java&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> SOURCE_CODE <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>CHILDREN_SOURCE_CODE_NAME<span class="token punctuation">,</span> PARENT_SOURCE_CODE_NAME<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        SOURCE_CODE<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>path <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">// \u8DEF\u5F84\u8F6C\u6587\u4EF6\u5BF9\u8C61</span>
            <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>f <span class="token operator">-&gt;</span> <span class="token operator">!</span>f<span class="token punctuation">.</span><span class="token function">isDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">// \u6587\u4EF6\u904D\u5386</span>
            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>f <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u62F7\u8D1D\u540E\u6E90\u4EE3\u7801</span>
            <span class="token class-name">File</span> targetFile <span class="token operator">=</span> <span class="token function">copySourceFile</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u7F16\u8BD1\u6E90\u4EE3\u7801</span>
            <span class="token function">compileSourceFile</span><span class="token punctuation">(</span>targetFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>- \u62F7\u8D1D\u5355\u4E00\u6E90\u6587\u4EF6\u5230\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u7684\u7C7B\u52A0\u8F7D\u76EE\u5F55\u3002
</code></pre><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>     <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token class-name">File</span> <span class="token function">copySourceFile</span><span class="token punctuation">(</span><span class="token class-name">File</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedWriter</span> writer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// package ...;</span>
            <span class="token class-name">String</span> firstLine <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">StringTokenizer</span> tokenizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringTokenizer</span><span class="token punctuation">(</span>firstLine<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> packageName <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>tokenizer<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> e <span class="token operator">=</span> tokenizer<span class="token punctuation">.</span><span class="token function">nextToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;package&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    packageName <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// package -&gt; path</span>
            <span class="token class-name">String</span> packagePath <span class="token operator">=</span> packageName<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;//&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// java file path</span>
            <span class="token class-name">String</span> targetFileLocation <span class="token operator">=</span> TARGET_CODE_LOCALTION <span class="token operator">+</span> <span class="token string">&quot;//&quot;</span> <span class="token operator">+</span> packagePath <span class="token operator">+</span> <span class="token string">&quot;//&quot;</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> sourceFilePath <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fileName <span class="token operator">=</span> sourceFilePath<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>sourceFilePath<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;\\\\&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">File</span> targetFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>targetFileLocation<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">File</span> targetFileLocationDir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>targetFileLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>targetFileLocationDir<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                targetFileLocationDir<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// writer</span>
            writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>targetFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u5199\u5165\u7B2C\u4E00\u884C</span>
            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>firstLine<span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            writer<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> input <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>input <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
                writer<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> targetFile<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>- \u5BF9\u62F7\u8D1D\u540E\u7684.java\u6E90\u6587\u4EF6\u6267\u884C\u624B\u52A8\u7F16\u8BD1\uFF0C\u5728\u540C\u7EA7\u76EE\u5F55\u4E0B\u751F\u6210.class\u6587\u4EF6\u3002
</code></pre><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token keyword">protected</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">compileSourceFile</span><span class="token punctuation">(</span><span class="token class-name">File</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">JavaCompiler</span> javaCompiler <span class="token operator">=</span> <span class="token class-name">ToolProvider</span><span class="token punctuation">.</span><span class="token function">getSystemJavaCompiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">StandardJavaFileManager</span> standardFileManager <span class="token operator">=</span> javaCompiler<span class="token punctuation">.</span><span class="token function">getStandardFileManager</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">JavaFileObject</span><span class="token punctuation">&gt;</span></span> javaFileObjects <span class="token operator">=</span> standardFileManager<span class="token punctuation">.</span><span class="token function">getJavaFileObjects</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// \u6267\u884C\u7F16\u8BD1\u4EFB\u52A1</span>
            <span class="token class-name">CompilationTask</span> task <span class="token operator">=</span> javaCompiler<span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> standardFileManager<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> javaFileObjects<span class="token punctuation">)</span><span class="token punctuation">;</span>
            task<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            standardFileManager<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>- \u901A\u8FC7\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668\u52A0\u8F7DChildren\u7684java.lang.Class&lt;?&gt;\u5BF9\u8C61\uFF0C\u7136\u540E\u7528\u53CD\u5C04\u673A\u5236\u521B\u5EFAChildren\u7684\u5B9E\u4F8B\u5BF9\u8C61\u3002
</code></pre><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</span>
        <span class="token class-name">CustomClassLoader</span> classLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomClassLoader</span><span class="token punctuation">(</span>TARGET_CODE_LOCALTION<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// E://myclassloader//classpath</span>
        <span class="token comment">// \u52A8\u6001\u52A0\u8F7Dclass\u6587\u4EF6\u5230\u5185\u5B58\u4E2D\uFF08\u65E0\u8FDE\u63A5\uFF09</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">&quot;org.ostenant.jdk8.learning.examples.classloader.custom.Children&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u901A\u8FC7\u53CD\u5C04\u62FF\u5230\u6240\u6709\u7684\u65B9\u6CD5</span>
        <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> declaredMethods <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> method <span class="token operator">:</span> declaredMethods<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// \u901A\u8FC7\u53CD\u5C04\u62FF\u5230children\u5BF9\u8C61</span>
                <span class="token class-name">Object</span> children <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// \u8C03\u7528children\u7684say()\u65B9\u6CD5</span>
                method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7F16\u5199\u7684\u7C7B\u52A0\u8F7D\u5668" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u7F16\u5199\u7684\u7C7B\u52A0\u8F7D\u5668" aria-hidden="true">#</a> \u6D4B\u8BD5\u7F16\u5199\u7684\u7C7B\u52A0\u8F7D\u5668</h4><h5 id="\u573A\u666F\u4E00" tabindex="-1"><a class="header-anchor" href="#\u573A\u666F\u4E00" aria-hidden="true">#</a> \u573A\u666F\u4E00</h5><ol><li><strong>\u4FDD\u7559</strong><code>static</code>\u4EE3\u7801\u5757\uFF0C\u628A\u76EE\u6807\u7C7B<code>Children.java</code>\u548C<code>Parent.java</code><strong>\u62F7\u8D1D</strong>\u5230\u7C7B\u52A0\u8F7D\u7684\u76EE\u5F55\uFF0C\u7136\u540E\u8FDB\u884C\u624B\u52A8<strong>\u7F16\u8BD1</strong>\u3002</li><li>\u4FDD\u7559\u6D4B\u8BD5\u9879\u76EE\u76EE\u5F55\u4E2D\u7684\u76EE\u6807\u7C7B<code>Children.java</code>\u548C<code>Parent.java</code>\u3002 <img src="`+d+'" alt=""></li></ol><p>\u7ED3\u679C\uFF1A <img src="'+u+'" alt=""></p><p>\u5206\u6790\uFF1A</p><blockquote><p>\u6211\u4EEC\u6210\u529F\u521B\u5EFA\u4E86<code>Children</code>\u5BF9\u8C61\uFF0C\u5E76\u901A\u8FC7\u53CD\u5C04\u8C03\u7528\u4E86\u5B83\u7684<code>say()</code>\u65B9\u6CD5\u3002 \u7136\u800C\u67E5\u770B\u63A7\u5236\u53F0\u65E5\u5FD7\uFF0C\u53EF\u4EE5\u53D1\u73B0\u7C7B\u52A0\u8F7D\u4F7F\u7528\u7684\u4ECD\u7136\u662F<code>AppClassLoader</code>\uFF0C<code>CustomClassLoader</code>\u5E76\u6CA1\u6709\u751F\u6548\u3002</p></blockquote><p>\u67E5\u770B<code>CustomClassLoader</code>\u7684\u7C7B\u52A0\u8F7D\u76EE\u5F55\uFF1A <img src="'+k+'" alt=""></p><blockquote><p>\u7C7B\u76EE\u5F55\u4E0B\u6709\u6211\u4EEC\u62F7\u8D1D\u5E76\u7F16\u8BD1\u7684Parent\u548CChidren\u6587\u4EF6\u3002</p></blockquote><p>\u5206\u6790\u539F\u56E0\uFF1A</p><blockquote><p>\u7531\u4E8E\u9879\u76EE\u7A7A\u95F4\u4E2D\u7684<code>Parent.java</code>\u548C<code>Children.java</code>\uFF0C\u5728\u62F7\u8D1D\u540E\u5E76\u6CA1\u6709\u79FB\u9664\u3002\u5BFC\u81F4<code>AppClassLoader</code>\u4F18\u5148\u5728\u5176<code>Classpath</code>\u4E0B\u9762\u627E\u5230\u5E76\u6210\u529F\u52A0\u8F7D\u4E86\u76EE\u6807\u7C7B\u3002</p></blockquote><h5 id="\u573A\u666F\u4E8C" tabindex="-1"><a class="header-anchor" href="#\u573A\u666F\u4E8C" aria-hidden="true">#</a> \u573A\u666F\u4E8C</h5><ol><li><strong>\u6CE8\u91CA\u6389</strong><code>static</code>\u4EE3\u7801\u5757\uFF08\u7C7B\u76EE\u5F55\u4E0B\u6709\u5DF2\u7F16\u8BD1\u7684\u76EE\u6807\u7C7B<code>.class</code>\u6587\u4EF6\uFF09\u3002</li><li><strong>\u79FB\u9664</strong>\u6D4B\u8BD5\u9879\u76EE\u76EE\u5F55\u4E2D\u7684\u76EE\u6807\u7C7B<code>Children.java</code>\u548C<code>Parent.java</code>\u3002 <img src="'+v+'" alt=""></li></ol><p>\u6D4B\u8BD5\u7ED3\u679C\u5206\u6790\uFF1A \u6211\u4EEC\u6210\u529F\u901A\u8FC7<strong>\u81EA\u5B9A\u4E49\u7C7B\u52A0\u8F7D\u5668</strong>\u52A0\u8F7D\u4E86\u76EE\u6807\u7C7B\u3002\u521B\u5EFA\u4E86<code>Children</code>\u5BF9\u8C61\uFF0C\u5E76\u901A\u8FC7\u53CD\u5C04\u8C03\u7528\u4E86\u5B83\u7684<code>say()</code>\u65B9\u6CD5\u3002</p><h2 id="\u5185\u5B58\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u5185\u5B58\u7ED3\u6784" aria-hidden="true">#</a> \u5185\u5B58\u7ED3\u6784</h2><p>JVM\u5185\u5B58\u7ED3\u6784\u4E3B\u8981\u6709\u4E09\u5927\u5757\uFF1A<strong>\u5806\u5185\u5B58</strong>\u3001<strong>\u65B9\u6CD5\u533A</strong>\u548C<strong>\u6808</strong>\u3002\u5806\u5185\u5B58\u662FJVM\u4E2D\u6700\u5927\u7684\u4E00\u5757\u7531\u5E74\u8F7B\u4EE3\u548C\u8001\u5E74\u4EE3\u7EC4\u6210\uFF0C\u800C\u5E74\u8F7B\u4EE3\u5185\u5B58\u53C8\u88AB\u5206\u6210\u4E09\u90E8\u5206\uFF0C<strong>Eden\u7A7A\u95F4</strong>\u3001<strong>From Survivor\u7A7A\u95F4</strong>\u3001<strong>To Survivor\u7A7A\u95F4</strong>,\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u5E74\u8F7B\u4EE3\u6309\u7167<strong>8:1:1</strong>\u7684\u6BD4\u4F8B\u6765\u5206\u914D\uFF1B</p><p>\u65B9\u6CD5\u533A\u5B58\u50A8\u7C7B\u4FE1\u606F\u3001\u5E38\u91CF\u3001\u9759\u6001\u53D8\u91CF\u7B49\u6570\u636E\uFF0C\u662F\u7EBF\u7A0B\u5171\u4EAB\u7684\u533A\u57DF\uFF0C\u4E3A\u4E0EJava\u5806\u533A\u5206\uFF0C\u65B9\u6CD5\u533A\u8FD8\u6709\u4E00\u4E2A\u522B\u540DNon-Heap(\u975E\u5806)\uFF1B\u6808\u53C8\u5206\u4E3Ajava\u865A\u62DF\u673A\u6808\u548C\u672C\u5730\u65B9\u6CD5\u6808\u4E3B\u8981\u7528\u4E8E\u65B9\u6CD5\u7684\u6267\u884C\u3002 <img src="'+g+`" alt=""></p><p>args\u53C2\u6570:</p><ul><li>-Xms\u8BBE\u7F6E\u5806\u7684\u6700\u5C0F\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-Xmx\u8BBE\u7F6E\u5806\u7684\u6700\u5927\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-XX:NewSize\u8BBE\u7F6E\u65B0\u751F\u4EE3\u6700\u5C0F\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-XX:MaxNewSize\u8BBE\u7F6E\u65B0\u751F\u4EE3\u6700\u5927\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-XX:PermSize\u8BBE\u7F6E\u6C38\u4E45\u4EE3\u6700\u5C0F\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-XX:MaxPermSize\u8BBE\u7F6E\u6C38\u4E45\u4EE3\u6700\u5927\u7A7A\u95F4\u5927\u5C0F\u3002</li><li>-Xss\u8BBE\u7F6E\u6BCF\u4E2A\u7EBF\u7A0B\u7684\u5806\u6808\u5927\u5C0F\u3002</li></ul><p>\u8001\u5E74\u4EE3\u7A7A\u95F4\u5927\u5C0F=\u5806\u7A7A\u95F4\u5927\u5C0F-\u5E74\u8F7B\u4EE3\u5927\u7A7A\u95F4\u5927\u5C0F</p><h3 id="java\u5806-heap" tabindex="-1"><a class="header-anchor" href="#java\u5806-heap" aria-hidden="true">#</a> Java\u5806\uFF08Heap\uFF09</h3><p>\u5BF9\u4E8E\u5927\u591A\u6570\u5E94\u7528\u6765\u8BF4\uFF0CJava\u5806\uFF08Java Heap\uFF09\u662FJava\u865A\u62DF\u673A\u6240\u7BA1\u7406\u7684\u5185\u5B58\u4E2D<strong>\u6700\u5927</strong>\u7684\u4E00\u5757\u3002Java\u5806\u662F\u88AB\u6240\u6709\u7EBF\u7A0B\u5171\u4EAB\u7684\u4E00\u5757\u5185\u5B58\u533A\u57DF\uFF0C\u5728\u865A\u62DF\u673A\u542F\u52A8\u65F6\u521B\u5EFA\u3002\u6B64\u5185\u5B58\u533A\u57DF\u7684\u552F\u4E00\u76EE\u7684\u5C31\u662F\u5B58\u653E\u5BF9\u8C61\u5B9E\u4F8B\uFF0C<strong>\u51E0\u4E4E\u6240\u6709\u7684\u5BF9\u8C61\u5B9E\u4F8B\u90FD\u5728\u8FD9\u91CC\u5206\u914D\u5185\u5B58</strong>\u3002</p><p>Java\u5806\u662F\u5783\u573E\u6536\u96C6\u5668\u7BA1\u7406\u7684\u4E3B\u8981\u533A\u57DF\uFF0C\u56E0\u6B64\u5F88\u591A\u65F6\u5019\u4E5F\u88AB\u79F0\u505A\u201C<strong>GC\u5806</strong>\u201D\u3002\u5982\u679C\u4ECE\u5185\u5B58\u56DE\u6536\u7684\u89D2\u5EA6\u770B\uFF0C\u7531\u4E8E\u73B0\u5728\u6536\u96C6\u5668\u57FA\u672C\u90FD\u662F\u91C7\u7528\u7684\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5\uFF0C\u6240\u4EE5Java\u5806\u4E2D\u8FD8\u53EF\u4EE5\u7EC6\u5206\u4E3A\uFF1A<strong>\u65B0\u751F\u4EE3\u548C\u8001\u5E74\u4EE3</strong>\uFF1B\u518D\u7EC6\u81F4\u4E00\u70B9\u7684\u6709<strong>Eden\u7A7A\u95F4</strong>\u3001<strong>From Survivor\u7A7A\u95F4</strong>\u3001<strong>To Survivor\u7A7A\u95F4</strong>\u7B49\u3002</p><p>\u6839\u636EJava\u865A\u62DF\u673A\u89C4\u8303\u7684\u89C4\u5B9A\uFF0CJava\u5806\u53EF\u4EE5\u5904\u4E8E\u7269\u7406\u4E0A\u4E0D\u8FDE\u7EED\u7684\u5185\u5B58\u7A7A\u95F4\u4E2D\uFF0C\u53EA\u8981\u903B\u8F91\u4E0A\u662F\u8FDE\u7EED\u7684\u5373\u53EF\uFF0C\u5C31\u50CF\u6211\u4EEC\u7684\u78C1\u76D8\u7A7A\u95F4\u4E00\u6837\u3002\u5728\u5B9E\u73B0\u65F6\uFF0C\u65E2\u53EF\u4EE5\u5B9E\u73B0\u6210\u56FA\u5B9A\u5927\u5C0F\u7684\uFF0C\u4E5F\u53EF\u4EE5\u662F\u53EF\u6269\u5C55\u7684\uFF0C\u4E0D\u8FC7\u5F53\u524D\u4E3B\u6D41\u7684\u865A\u62DF\u673A\u90FD\u662F\u6309\u7167\u53EF\u6269\u5C55\u6765\u5B9E\u73B0\u7684\uFF08\u901A\u8FC7-Xmx\u548C-Xms\u63A7\u5236\uFF09\u3002</p><p>\u5982\u679C\u5728\u5806\u4E2D\u6CA1\u6709\u5185\u5B58\u5B8C\u6210\u5B9E\u4F8B\u5206\u914D\uFF0C\u5E76\u4E14\u5806\u4E5F\u65E0\u6CD5\u518D\u6269\u5C55\u65F6\uFF0C\u5C06\u4F1A\u629B\u51FAOutOfMemoryError\u5F02\u5E38\u3002</p><h4 id="\u65B9\u6CD5\u533A-method-area" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5\u533A-method-area" aria-hidden="true">#</a> \u65B9\u6CD5\u533A\uFF08Method Area\uFF09</h4><p>\u65B9\u6CD5\u533A\uFF08Method Area\uFF09\u4E0EJava\u5806\u4E00\u6837\uFF0C\u662F\u5404\u4E2A\u7EBF\u7A0B\u5171\u4EAB\u7684\u5185\u5B58\u533A\u57DF\uFF0C<strong>\u5B83\u7528\u4E8E\u5B58\u50A8\u5DF2\u88AB\u865A\u62DF\u673A\u52A0\u8F7D\u7684\u7C7B\u4FE1\u606F\u3001\u5E38\u91CF\u3001\u9759\u6001\u53D8\u91CF\u3001\u5373\u65F6\u7F16\u8BD1\u5668\u7F16\u8BD1\u540E\u7684\u4EE3\u7801\u7B49\u6570\u636E</strong>\u3002\u867D\u7136Java\u865A\u62DF\u673A\u89C4\u8303\u628A\u65B9\u6CD5\u533A\u63CF\u8FF0\u4E3A\u5806\u7684\u4E00\u4E2A\u903B\u8F91\u90E8\u5206\uFF0C\u4F46\u662F\u5B83\u5374\u6709\u4E00\u4E2A\u522B\u540D\u53EB\u505ANon-Heap\uFF08\u975E\u5806\uFF09\uFF0C\u76EE\u7684\u5E94\u8BE5\u662F\u4E0EJava\u5806\u533A\u5206\u5F00\u6765\u3002</p><p>\u5BF9\u4E8E\u4E60\u60EF\u5728HotSpot\u865A\u62DF\u673A\u4E0A\u5F00\u53D1\u548C\u90E8\u7F72\u7A0B\u5E8F\u7684\u5F00\u53D1\u8005\u6765\u8BF4\uFF0C\u5F88\u591A\u4EBA\u613F\u610F\u628A\u65B9\u6CD5\u533A\u79F0\u4E3A\u201C\u6C38\u4E45\u4EE3\u201D\uFF08Permanent Generation\uFF09\uFF0C\u672C\u8D28\u4E0A\u4E24\u8005\u5E76\u4E0D\u7B49\u4EF7\uFF0C\u4EC5\u4EC5\u662F\u56E0\u4E3AHotSpot\u865A\u62DF\u673A\u7684\u8BBE\u8BA1\u56E2\u961F\u9009\u62E9\u628AGC\u5206\u4EE3\u6536\u96C6\u6269\u5C55\u81F3\u65B9\u6CD5\u533A\uFF0C\u6216\u8005\u8BF4\u4F7F\u7528\u6C38\u4E45\u4EE3\u6765\u5B9E\u73B0\u65B9\u6CD5\u533A\u800C\u5DF2\u3002</p><p>Java\u865A\u62DF\u673A\u89C4\u8303\u5BF9\u8FD9\u4E2A\u533A\u57DF\u7684\u9650\u5236\u975E\u5E38\u5BBD\u677E\uFF0C\u9664\u4E86\u548CJava\u5806\u4E00\u6837\u4E0D\u9700\u8981\u8FDE\u7EED\u7684\u5185\u5B58\u548C\u53EF\u4EE5\u9009\u62E9\u56FA\u5B9A\u5927\u5C0F\u6216\u8005\u53EF\u6269\u5C55\u5916\uFF0C\u8FD8\u53EF\u4EE5\u9009\u62E9\u4E0D\u5B9E\u73B0\u5783\u573E\u6536\u96C6\u3002\u76F8\u5BF9\u800C\u8A00\uFF0C\u5783\u573E\u6536\u96C6\u884C\u4E3A\u5728\u8FD9\u4E2A\u533A\u57DF\u662F\u6BD4\u8F83\u5C11\u51FA\u73B0\u7684\uFF0C\u4F46\u5E76\u975E\u6570\u636E\u8FDB\u5165\u4E86\u65B9\u6CD5\u533A\u5C31\u5982\u6C38\u4E45\u4EE3\u7684\u540D\u5B57\u4E00\u6837\u201C\u6C38\u4E45\u201D\u5B58\u5728\u4E86\u3002\u8FD9\u4E2A\u533A\u57DF\u7684\u5185\u5B58\u56DE\u6536\u76EE\u6807\u4E3B\u8981\u662F\u9488\u5BF9\u5E38\u91CF\u6C60\u7684\u56DE\u6536\u548C\u5BF9\u7C7B\u578B\u7684\u5378\u8F7D\uFF0C\u4E00\u822C\u6765\u8BF4\u8FD9\u4E2A\u533A\u57DF\u7684\u56DE\u6536\u201C\u6210\u7EE9\u201D\u6BD4\u8F83\u96BE\u4EE5\u4EE4\u4EBA\u6EE1\u610F\uFF0C\u5C24\u5176\u662F\u7C7B\u578B\u7684\u5378\u8F7D\uFF0C\u6761\u4EF6\u76F8\u5F53\u82DB\u523B\uFF0C\u4F46\u662F\u8FD9\u90E8\u5206\u533A\u57DF\u7684\u56DE\u6536\u786E\u5B9E\u662F\u6709\u5FC5\u8981\u7684\u3002</p><p>\u6839\u636EJava\u865A\u62DF\u673A\u89C4\u8303\u7684\u89C4\u5B9A\uFF0C\u5F53\u65B9\u6CD5\u533A\u65E0\u6CD5\u6EE1\u8DB3\u5185\u5B58\u5206\u914D\u9700\u6C42\u65F6\uFF0C\u5C06\u629B\u51FAOutOfMemoryError\u5F02\u5E38\u3002</p><p>\u65B9\u6CD5\u533A\u6709\u65F6\u88AB\u79F0\u4E3A\u6301\u4E45\u4EE3\uFF08PermGen\uFF09\u3002</p><p>\u6240\u6709\u7684\u5BF9\u8C61\u5728\u5B9E\u4F8B\u5316\u540E\u7684\u6574\u4E2A\u8FD0\u884C\u5468\u671F\u5185\uFF0C\u90FD\u88AB\u5B58\u653E\u5728\u5806\u5185\u5B58\u4E2D\u3002\u5806\u5185\u5B58\u53C8\u88AB\u5212\u5206\u6210\u4E0D\u540C\u7684\u90E8\u5206\uFF1A\u4F0A\u7538\u533A(Eden)\uFF0C\u5E78\u5B58\u8005\u533A\u57DF(Survivor Sapce)\uFF0C\u8001\u5E74\u4EE3\uFF08Old Generation Space\uFF09\u3002</p><p>\u65B9\u6CD5\u7684\u6267\u884C\u90FD\u662F\u4F34\u968F\u7740\u7EBF\u7A0B\u7684\u3002\u539F\u59CB\u7C7B\u578B\u7684\u672C\u5730\u53D8\u91CF\u4EE5\u53CA\u5F15\u7528\u90FD\u5B58\u653E\u5728\u7EBF\u7A0B\u6808\u4E2D\u3002\u800C\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61\u6BD4\u5982String\uFF0C\u90FD\u5B58\u5728\u5728\u5806\u4E2D\u3002\u4E3A\u4E86\u66F4\u597D\u7684\u7406\u89E3\u4E0A\u9762\u8FD9\u6BB5\u8BDD\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u4E00\u4E2A\u4F8B\u5B50\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span> <span class="token class-name">Logger</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">HelloWorld</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SimpleDateFormat</span> formatter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;dd.MM.YYYY&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> today <span class="token operator">=</span> formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>today <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5185\u5B58\u56FE</p><p><img src="`+m+'" alt=""> \u901A\u8FC7JConsole\u5DE5\u5177\u53EF\u4EE5\u67E5\u770B\u8FD0\u884C\u4E2D\u7684Java\u7A0B\u5E8F\uFF08\u6BD4\u5982Eclipse\uFF09\u7684\u4E00\u4E9B\u4FE1\u606F\uFF1A\u5806\u5185\u5B58\u7684\u5206\u914D\uFF0C\u7EBF\u7A0B\u7684\u6570\u91CF\u4EE5\u53CA\u52A0\u8F7D\u7684\u7C7B\u7684\u4E2A\u6570\uFF1B <img src="'+b+`" alt=""></p><h3 id="\u7A0B\u5E8F\u8BA1\u6570\u5668-program-counter-register" tabindex="-1"><a class="header-anchor" href="#\u7A0B\u5E8F\u8BA1\u6570\u5668-program-counter-register" aria-hidden="true">#</a> \u7A0B\u5E8F\u8BA1\u6570\u5668\uFF08Program Counter Register\uFF09</h3><p>\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF08Program Counter Register\uFF09\u662F\u4E00\u5757\u8F83\u5C0F\u7684\u5185\u5B58\u7A7A\u95F4\uFF0C\u5B83\u7684\u4F5C\u7528\u53EF\u4EE5\u770B\u505A\u662F\u5F53\u524D\u7EBF\u7A0B\u6240\u6267\u884C\u7684\u5B57\u8282\u7801\u7684\u884C\u53F7\u6307\u793A\u5668\u3002\u5728\u865A\u62DF\u673A\u7684\u6982\u5FF5\u6A21\u578B\u91CC\uFF08\u4EC5\u662F\u6982\u5FF5\u6A21\u578B\uFF0C\u5404\u79CD\u865A\u62DF\u673A\u53EF\u80FD\u4F1A\u901A\u8FC7\u4E00\u4E9B\u66F4\u9AD8\u6548\u7684\u65B9\u5F0F\u53BB\u5B9E\u73B0\uFF09\uFF0C\u5B57\u8282\u7801\u89E3\u91CA\u5668\u5DE5\u4F5C\u65F6\u5C31\u662F\u901A\u8FC7\u6539\u53D8\u8FD9\u4E2A\u8BA1\u6570\u5668\u7684\u503C\u6765\u9009\u53D6\u4E0B\u4E00\u6761\u9700\u8981\u6267\u884C\u7684\u5B57\u8282\u7801\u6307\u4EE4\uFF0C\u5206\u652F\u3001\u5FAA\u73AF\u3001\u8DF3\u8F6C\u3001\u5F02\u5E38\u5904\u7406\u3001\u7EBF\u7A0B\u6062\u590D\u7B49\u57FA\u7840\u529F\u80FD\u90FD\u9700\u8981\u4F9D\u8D56\u8FD9\u4E2A\u8BA1\u6570\u5668\u6765\u5B8C\u6210\u3002</p><p>\u7531\u4E8EJava\u865A\u62DF\u673A\u7684\u591A\u7EBF\u7A0B\u662F\u901A\u8FC7\u7EBF\u7A0B\u8F6E\u6D41\u5207\u6362\u5E76\u5206\u914D\u5904\u7406\u5668\u6267\u884C\u65F6\u95F4\u7684\u65B9\u5F0F\u6765\u5B9E\u73B0\u7684\uFF0C\u5728\u4EFB\u4F55\u4E00\u4E2A\u786E\u5B9A\u7684\u65F6\u523B\uFF0C\u4E00\u4E2A\u5904\u7406\u5668\uFF08\u5BF9\u4E8E\u591A\u6838\u5904\u7406\u5668\u6765\u8BF4\u662F\u4E00\u4E2A\u5185\u6838\uFF09\u53EA\u4F1A\u6267\u884C\u4E00\u6761\u7EBF\u7A0B\u4E2D\u7684\u6307\u4EE4\u3002\u56E0\u6B64\uFF0C\u4E3A\u4E86\u7EBF\u7A0B\u5207\u6362\u540E\u80FD\u6062\u590D\u5230\u6B63\u786E\u7684\u6267\u884C\u4F4D\u7F6E\uFF0C\u6BCF\u6761\u7EBF\u7A0B\u90FD\u9700\u8981\u6709\u4E00\u4E2A\u72EC\u7ACB\u7684\u7A0B\u5E8F\u8BA1\u6570\u5668\uFF0C\u5404\u6761\u7EBF\u7A0B\u4E4B\u95F4\u7684\u8BA1\u6570\u5668\u4E92\u4E0D\u5F71\u54CD\uFF0C\u72EC\u7ACB\u5B58\u50A8\uFF0C\u6211\u4EEC\u79F0\u8FD9\u7C7B\u5185\u5B58\u533A\u57DF\u4E3A\u201C\u7EBF\u7A0B\u79C1\u6709\u201D\u7684\u5185\u5B58\u3002</p><p>\u5982\u679C\u7EBF\u7A0B\u6B63\u5728\u6267\u884C\u7684\u662F\u4E00\u4E2AJava\u65B9\u6CD5\uFF0C\u8FD9\u4E2A\u8BA1\u6570\u5668\u8BB0\u5F55\u7684\u662F\u6B63\u5728\u6267\u884C\u7684\u865A\u62DF\u673A\u5B57\u8282\u7801\u6307\u4EE4\u7684\u5730\u5740\uFF1B\u5982\u679C\u6B63\u5728\u6267\u884C\u7684\u662FNatvie\u65B9\u6CD5\uFF0C\u8FD9\u4E2A\u8BA1\u6570\u5668\u503C\u5219\u4E3A\u7A7A\uFF08Undefined\uFF09\u3002</p><p><strong>\u6B64\u5185\u5B58\u533A\u57DF\u662F\u552F\u4E00\u4E00\u4E2A\u5728Java\u865A\u62DF\u673A\u89C4\u8303\u4E2D\u6CA1\u6709\u89C4\u5B9A\u4EFB\u4F55OutOfMemoryError\u60C5\u51B5\u7684\u533A\u57DF\u3002</strong></p><h3 id="jvm\u6808-jvm-stacks" tabindex="-1"><a class="header-anchor" href="#jvm\u6808-jvm-stacks" aria-hidden="true">#</a> JVM\u6808\uFF08JVM Stacks\uFF09</h3><p>\u4E0E\u7A0B\u5E8F\u8BA1\u6570\u5668\u4E00\u6837\uFF0CJava\u865A\u62DF\u673A\u6808\uFF08Java Virtual Machine Stacks\uFF09\u4E5F\u662F\u7EBF\u7A0B\u79C1\u6709\u7684\uFF0C<strong>\u5B83\u7684\u751F\u547D\u5468\u671F\u4E0E\u7EBF\u7A0B\u76F8\u540C</strong>\u3002<strong>\u865A\u62DF\u673A\u6808\u63CF\u8FF0\u7684\u662FJava\u65B9\u6CD5\u6267\u884C\u7684\u5185\u5B58\u6A21\u578B</strong>\uFF1A\u6BCF\u4E2A\u65B9\u6CD5\u88AB\u6267\u884C\u7684\u65F6\u5019\u90FD\u4F1A\u540C\u65F6\u521B\u5EFA\u4E00\u4E2A\u6808\u5E27\uFF08Stack Frame\uFF09\u7528\u4E8E\u5B58\u50A8\u5C40\u90E8\u53D8\u91CF\u8868\u3001\u64CD\u4F5C\u6808\u3001\u52A8\u6001\u94FE\u63A5\u3001\u65B9\u6CD5\u51FA\u53E3\u7B49\u4FE1\u606F\u3002<strong>\u6BCF\u4E00\u4E2A\u65B9\u6CD5\u88AB\u8C03\u7528\u76F4\u81F3\u6267\u884C\u5B8C\u6210\u7684\u8FC7\u7A0B\uFF0C\u5C31\u5BF9\u5E94\u7740\u4E00\u4E2A\u6808\u5E27\u5728\u865A\u62DF\u673A\u6808\u4E2D\u4ECE\u5165\u6808\u5230\u51FA\u6808\u7684\u8FC7\u7A0B\u3002</strong></p><p>\u5C40\u90E8\u53D8\u91CF\u8868\u5B58\u653E\u4E86\u7F16\u8BD1\u671F\u53EF\u77E5\u7684\u5404\u79CD\u57FA\u672C\u6570\u636E\u7C7B\u578B\uFF08boolean\u3001byte\u3001char\u3001short\u3001int\u3001float\u3001long\u3001double\uFF09\u3001\u5BF9\u8C61\u5F15\u7528\uFF08reference\u7C7B\u578B\uFF0C\u5B83\u4E0D\u7B49\u540C\u4E8E\u5BF9\u8C61\u672C\u8EAB\uFF0C\u6839\u636E\u4E0D\u540C\u7684\u865A\u62DF\u673A\u5B9E\u73B0\uFF0C\u5B83\u53EF\u80FD\u662F\u4E00\u4E2A\u6307\u5411\u5BF9\u8C61\u8D77\u59CB\u5730\u5740\u7684\u5F15\u7528\u6307\u9488\uFF0C\u4E5F\u53EF\u80FD\u6307\u5411\u4E00\u4E2A\u4EE3\u8868\u5BF9\u8C61\u7684\u53E5\u67C4\u6216\u8005\u5176\u4ED6\u4E0E\u6B64\u5BF9\u8C61\u76F8\u5173\u7684\u4F4D\u7F6E\uFF09\u548CreturnAddress\u7C7B\u578B\uFF08\u6307\u5411\u4E86\u4E00\u6761\u5B57\u8282\u7801\u6307\u4EE4\u7684\u5730\u5740\uFF09\u3002</p><p>\u5176\u4E2D64\u4F4D\u957F\u5EA6\u7684long\u548Cdouble\u7C7B\u578B\u7684\u6570\u636E\u4F1A\u5360\u75282\u4E2A\u5C40\u90E8\u53D8\u91CF\u7A7A\u95F4\uFF08Slot\uFF09\uFF0C\u5176\u4F59\u7684\u6570\u636E\u7C7B\u578B\u53EA\u5360\u75281\u4E2A\u3002\u5C40\u90E8\u53D8\u91CF\u8868\u6240\u9700\u7684\u5185\u5B58\u7A7A\u95F4\u5728\u7F16\u8BD1\u671F\u95F4\u5B8C\u6210\u5206\u914D\uFF0C\u5F53\u8FDB\u5165\u4E00\u4E2A\u65B9\u6CD5\u65F6\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u9700\u8981\u5728\u5E27\u4E2D\u5206\u914D\u591A\u5927\u7684\u5C40\u90E8\u53D8\u91CF\u7A7A\u95F4\u662F\u5B8C\u5168\u786E\u5B9A\u7684\uFF0C\u5728\u65B9\u6CD5\u8FD0\u884C\u671F\u95F4\u4E0D\u4F1A\u6539\u53D8\u5C40\u90E8\u53D8\u91CF\u8868\u7684\u5927\u5C0F\u3002</p><p>\u5728Java\u865A\u62DF\u673A\u89C4\u8303\u4E2D\uFF0C\u5BF9\u8FD9\u4E2A\u533A\u57DF\u89C4\u5B9A\u4E86\u4E24\u79CD\u5F02\u5E38\u72B6\u51B5\uFF1A\u5982\u679C\u7EBF\u7A0B\u8BF7\u6C42\u7684\u6808\u6DF1\u5EA6\u5927\u4E8E\u865A\u62DF\u673A\u6240\u5141\u8BB8\u7684\u6DF1\u5EA6\uFF0C\u5C06\u629B\u51FAStackOverflowError\u5F02\u5E38\uFF1B\u5982\u679C\u865A\u62DF\u673A\u6808\u53EF\u4EE5\u52A8\u6001\u6269\u5C55\uFF08\u5F53\u524D\u5927\u90E8\u5206\u7684Java\u865A\u62DF\u673A\u90FD\u53EF\u52A8\u6001\u6269\u5C55\uFF0C\u53EA\u4E0D\u8FC7Java\u865A\u62DF\u673A\u89C4\u8303\u4E2D\u4E5F\u5141\u8BB8\u56FA\u5B9A\u957F\u5EA6\u7684\u865A\u62DF\u673A\u6808\uFF09\uFF0C\u5F53\u6269\u5C55\u65F6\u65E0\u6CD5\u7533\u8BF7\u5230\u8DB3\u591F\u7684\u5185\u5B58\u65F6\u4F1A\u629B\u51FAOutOfMemoryError\u5F02\u5E38\u3002</p><h3 id="\u672C\u5730\u65B9\u6CD5\u6808-native-method-stacks" tabindex="-1"><a class="header-anchor" href="#\u672C\u5730\u65B9\u6CD5\u6808-native-method-stacks" aria-hidden="true">#</a> \u672C\u5730\u65B9\u6CD5\u6808\uFF08Native Method Stacks\uFF09</h3><p>\u672C\u5730\u65B9\u6CD5\u6808\uFF08Native Method Stacks\uFF09\u4E0E\u865A\u62DF\u673A\u6808\u6240\u53D1\u6325\u7684\u4F5C\u7528\u662F\u975E\u5E38\u76F8\u4F3C\u7684\uFF0C\u5176\u533A\u522B\u4E0D\u8FC7\u662F\u865A\u62DF\u673A\u6808\u4E3A\u865A\u62DF\u673A\u6267\u884CJava\u65B9\u6CD5\uFF08\u4E5F\u5C31\u662F\u5B57\u8282\u7801\uFF09\u670D\u52A1\uFF0C\u800C<strong>\u672C\u5730\u65B9\u6CD5\u6808\u5219\u662F\u4E3A\u865A\u62DF\u673A\u4F7F\u7528\u5230\u7684Native\u65B9\u6CD5\u670D\u52A1</strong>\u3002\u865A\u62DF\u673A\u89C4\u8303\u4E2D\u5BF9\u672C\u5730\u65B9\u6CD5\u6808\u4E2D\u7684\u65B9\u6CD5\u4F7F\u7528\u7684\u8BED\u8A00\u3001\u4F7F\u7528\u65B9\u5F0F\u4E0E\u6570\u636E\u7ED3\u6784\u5E76\u6CA1\u6709\u5F3A\u5236\u89C4\u5B9A\uFF0C\u56E0\u6B64\u5177\u4F53\u7684\u865A\u62DF\u673A\u53EF\u4EE5\u81EA\u7531\u5B9E\u73B0\u5B83\u3002\u751A\u81F3\u6709\u7684\u865A\u62DF\u673A\uFF08\u8B6C\u5982Sun HotSpot\u865A\u62DF\u673A\uFF09\u76F4\u63A5\u5C31\u628A\u672C\u5730\u65B9\u6CD5\u6808\u548C\u865A\u62DF\u673A\u6808\u5408\u4E8C\u4E3A\u4E00\u3002\u4E0E\u865A\u62DF\u673A\u6808\u4E00\u6837\uFF0C\u672C\u5730\u65B9\u6CD5\u6808\u533A\u57DF\u4E5F\u4F1A\u629B\u51FAStackOverflowError\u548COutOfMemoryError\u5F02\u5E38\u3002</p><h3 id="outofmemoryerrors\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#outofmemoryerrors\u5206\u6790" aria-hidden="true">#</a> OutOfMemoryErrors\u5206\u6790</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread \u201Cmain\u201D: java.lang.OutOfMemoryError: Java heap space
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5BF9\u8C61\u4E0D\u80FD\u88AB\u5206\u914D\u5230\u5806\u5185\u5B58\u4E2D</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread \u201Cmain\u201D: java.lang.OutOfMemoryError: PermGen space
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u7C7B\u6216\u8005\u65B9\u6CD5\u4E0D\u80FD\u88AB\u52A0\u8F7D\u5230\u6301\u4E45\u4EE3\u3002\u5B83\u53EF\u80FD\u51FA\u73B0\u5728\u4E00\u4E2A\u7A0B\u5E8F\u52A0\u8F7D\u5F88\u591A\u7C7B\u7684\u65F6\u5019\uFF0C\u6BD4\u5982\u5F15\u7528\u4E86\u5F88\u591A\u7B2C\u4E09\u65B9\u7684\u5E93</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread \u201Cmain\u201D: java.lang.OutOfMemoryError: Requested array size exceeds VM limit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u521B\u5EFA\u7684\u6570\u7EC4\u5927\u4E8E\u5806\u5185\u5B58\u7684\u7A7A\u95F4</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread \u201Cmain\u201D: java.lang.OutOfMemoryError: request &lt;size&gt; bytes for &lt;reason&gt;. Out of swap space?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5206\u914D\u672C\u5730\u5206\u914D\u5931\u8D25\u3002JNI\u3001\u672C\u5730\u5E93\u6216\u8005Java\u865A\u62DF\u673A\u90FD\u4F1A\u4ECE\u672C\u5730\u5806\u4E2D\u5206\u914D\u5185\u5B58\u7A7A\u95F4</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread \u201Cmain\u201D: java.lang.OutOfMemoryError: &lt;reason&gt; &lt;stack trace&gt;\uFF08Native method\uFF09
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u540C\u6837\u662F\u672C\u5730\u65B9\u6CD5\u5185\u5B58\u5206\u914D\u5931\u8D25\uFF0C\u53EA\u4E0D\u8FC7\u662FJNI\u6216\u8005\u672C\u5730\u65B9\u6CD5\u6216\u8005Java\u865A\u62DF\u673A\u53D1\u73B0</p><h2 id="jvm\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#jvm\u5BF9\u8C61" aria-hidden="true">#</a> JVM\u5BF9\u8C61</h2><h3 id="\u5BF9\u8C61\u7684\u521B\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u7684\u521B\u5EFA" aria-hidden="true">#</a> \u5BF9\u8C61\u7684\u521B\u5EFA</h3><p><code>Java</code> \u4E2D\u63D0\u4F9B\u7684\u51E0\u79CD\u5BF9\u8C61\u521B\u5EFA\u65B9\u5F0F\uFF1A</p><table><thead><tr><th>Header</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>\u4F7F\u7528new\u5173\u952E\u5B57</td><td>\u8C03\u7528\u4E86\u6784\u9020\u51FD\u6570</td></tr><tr><td>\u4F7F\u7528Class\u7684newInstance\u65B9\u6CD5</td><td>\u8C03\u7528\u4E86\u6784\u9020\u51FD\u6570</td></tr><tr><td>\u4F7F\u7528Constructor\u7C7B\u7684newInstance\u65B9\u6CD5</td><td>\u8C03\u7528\u4E86\u6784\u9020\u51FD\u6570</td></tr><tr><td>\u4F7F\u7528clone\u65B9\u6CD5</td><td>\u6CA1\u6709\u8C03\u7528\u6784\u9020\u51FD\u6570</td></tr><tr><td>\u4F7F\u7528\u53CD\u5E8F\u5217\u5316</td><td>\u6CA1\u6709\u8C03\u7528\u6784\u9020\u51FD\u6570</td></tr></tbody></table><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> prime <span class="token operator">=</span> <span class="token number">31</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> result <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> prime <span class="token operator">*</span> result <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> name<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>name<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>other<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Employee [name=&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            obj <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>new\u5173\u952E\u5B57 \u8FD9\u662F\u6700\u5E38\u89C1\u4E5F\u662F\u6700\u7B80\u5355\u7684\u521B\u5EFA\u5BF9\u8C61\u7684\u65B9\u5F0F\u4E86\u3002\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8C03\u7528\u4EFB\u610F\u7684\u6784\u9020\u51FD\u6570(\u65E0\u53C2\u7684\u548C\u5E26\u53C2\u6570\u7684)\u3002</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Employee</span> emp1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Employee</span> emp1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>Class\u7C7B\u7684newInstance\u65B9\u6CD5 \u6211\u4EEC\u4E5F\u53EF\u4EE5\u4F7F\u7528<code>Class</code>\u7C7B\u7684<code>newInstance</code>\u65B9\u6CD5\u521B\u5EFA\u5BF9\u8C61\u3002\u8FD9\u4E2A<code>newInstance</code>\u65B9\u6CD5\u8C03\u7528\u65E0\u53C2\u7684\u6784\u9020\u51FD\u6570\u521B\u5EFA\u5BF9\u8C61\u3002</li></ol><ul><li>\u65B9\u5F0F\u4E00</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token class-name">Employee</span> emp2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;org.ostenant.jvm.instance.Employee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u65B9\u5F0F\u4E8C</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Employee</span> emp2 <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>Constructor\u7C7B\u7684newInstance\u65B9\u6CD5 \u548C<code>Class</code>\u7C7B\u7684<code>newInstance</code>\u65B9\u6CD5\u5F88\u50CF\uFF0C <code>java.lang.reflect.Constructor</code>\u7C7B\u91CC\u4E5F\u6709\u4E00\u4E2A<code>newInstance</code>\u65B9\u6CD5\u53EF\u4EE5\u521B\u5EFA\u5BF9\u8C61\u3002\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u8FD9\u4E2A<code>newInstance</code>\u65B9\u6CD5\u8C03\u7528\u6709\u53C2\u6570\u7684\u548C\u79C1\u6709\u7684\u6784\u9020\u51FD\u6570\u3002\u5176\u4E2D\uFF0C<code>Constructor</code>\u53EF\u4EE5\u4ECE\u5BF9\u5E94\u7684<code>Class</code>\u7C7B\u4E2D\u83B7\u5F97\u3002</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> constructor <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Employee</span> emp3 <span class="token operator">=</span> constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u8FD9\u4E24\u79CDnewInstance\u65B9\u6CD5\u5C31\u662F\u5927\u5BB6\u6240\u8BF4\u7684\u53CD\u5C04\u3002\u4E8B\u5B9E\u4E0AClass\u7684newInstance\u65B9\u6CD5\u5185\u90E8\u8C03\u7528Constructor\u7684newInstance\u65B9\u6CD5\u3002</p></blockquote><ol start="4"><li>Clone\u65B9\u6CD5 \u65E0\u8BBA\u4F55\u65F6\u6211\u4EEC\u8C03\u7528\u4E00\u4E2A\u5BF9\u8C61\u7684<code>clone</code>\u65B9\u6CD5\uFF0C<code>JVM</code>\u90FD\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u5BF9\u8C61\uFF0C\u5C06\u524D\u9762\u5BF9\u8C61\u7684\u5185\u5BB9\u5168\u90E8\u62F7\u8D1D\u8FDB\u53BB\u3002\u7528<code>clone</code>\u65B9\u6CD5\u521B\u5EFA\u5BF9\u8C61\u5E76\u4E0D\u4F1A\u8C03\u7528\u4EFB\u4F55\u6784\u9020\u51FD\u6570\u3002</li></ol><p>\u4E3A\u4E86\u4F7F\u7528<code>clone</code>\u65B9\u6CD5\uFF0C\u6211\u4EEC\u9700\u8981\u5148\u5B9E\u73B0<code>Cloneable</code>\u63A5\u53E3\u5E76\u5B9E\u73B0\u5176\u5B9A\u4E49\u7684<code>clone</code>\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Employee</span> emp4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> emp3<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="5"><li>\u53CD\u5E8F\u5217\u5316 \u5F53\u6211\u4EEC<strong>\u5E8F\u5217\u5316</strong>\u548C<strong>\u53CD\u5E8F\u5217\u5316</strong>\u4E00\u4E2A\u5BF9\u8C61\uFF0C<code>JVM</code>\u4F1A\u7ED9\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A<strong>\u5355\u72EC</strong>\u7684\u5BF9\u8C61\u3002\u5728\u53CD\u5E8F\u5217\u5316\u65F6\uFF0C<code>JVM</code>\u521B\u5EFA\u5BF9\u8C61\u5E76\u4E0D\u4F1A\u8C03\u7528\u4EFB\u4F55\u6784\u9020\u51FD\u6570\u3002</li></ol><p>\u4E3A\u4E86\u53CD\u5E8F\u5217\u5316\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u6211\u4EEC\u9700\u8981\u8BA9\u6211\u4EEC\u7684\u7C7B\u5B9E\u73B0<code>Serializable</code>\u63A5\u53E3\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ByteArrayOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>emp4<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">ByteArrayInputStream</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>oos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Employee</span> emp5 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> in<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5BF9\u8C61\u7684\u8BBF\u95EE\u5B9A\u4F4D" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u7684\u8BBF\u95EE\u5B9A\u4F4D" aria-hidden="true">#</a> \u5BF9\u8C61\u7684\u8BBF\u95EE\u5B9A\u4F4D</h3><p><code>Java</code>\u7A0B\u5E8F\u9700\u8981\u901A\u8FC7 <code>JVM</code> \u6808\u4E0A\u7684\u5F15\u7528\u8BBF\u95EE\u5806\u4E2D\u7684\u5177\u4F53\u5BF9\u8C61\u3002\u5BF9\u8C61\u7684\u8BBF\u95EE\u65B9\u5F0F\u53D6\u51B3\u4E8E <code>JVM</code> \u865A\u62DF\u673A\u7684\u5B9E\u73B0\u3002\u76EE\u524D\u4E3B\u6D41\u7684\u8BBF\u95EE\u65B9\u5F0F\u6709 <strong>\u53E5\u67C4</strong> \u548C <strong>\u76F4\u63A5\u6307\u9488</strong> \u4E24\u79CD\u65B9\u5F0F\u3002</p><blockquote><p>\u6307\u9488\uFF1A \u6307\u5411\u5BF9\u8C61\uFF0C\u4EE3\u8868\u4E00\u4E2A\u5BF9\u8C61\u5728\u5185\u5B58\u4E2D\u7684\u8D77\u59CB\u5730\u5740\u3002</p></blockquote><blockquote><p>\u53E5\u67C4\uFF1A \u53EF\u4EE5\u7406\u89E3\u4E3A\u6307\u5411\u6307\u9488\u7684\u6307\u9488\uFF0C\u7EF4\u62A4\u7740\u5BF9\u8C61\u7684\u6307\u9488\u3002\u53E5\u67C4\u4E0D\u76F4\u63A5\u6307\u5411\u5BF9\u8C61\uFF0C\u800C\u662F\u6307\u5411\u5BF9\u8C61\u7684\u6307\u9488\uFF08\u53E5\u67C4\u4E0D\u53D1\u751F\u53D8\u5316\uFF0C\u6307\u5411\u56FA\u5B9A\u5185\u5B58\u5730\u5740\uFF09\uFF0C\u518D\u7531\u5BF9\u8C61\u7684\u6307\u9488\u6307\u5411\u5BF9\u8C61\u7684\u771F\u5B9E\u5185\u5B58\u5730\u5740\u3002</p></blockquote><ol><li><p>\u53E5\u67C4 <code>Java</code>\u5806\u4E2D\u5212\u5206\u51FA\u4E00\u5757\u5185\u5B58\u6765\u4F5C\u4E3A<strong>\u53E5\u67C4\u6C60</strong>\uFF0C\u5F15\u7528\u4E2D\u5B58\u50A8\u5BF9\u8C61\u7684<strong>\u53E5\u67C4\u5730\u5740</strong>\uFF0C\u800C\u53E5\u67C4\u4E2D\u5305\u542B\u4E86\u5BF9\u8C61<strong>\u5B9E\u4F8B\u6570\u636E</strong>\u4E0E<strong>\u5BF9\u8C61\u7C7B\u578B\u6570\u636E</strong>\u5404\u81EA\u7684<strong>\u5177\u4F53\u5730\u5740</strong>\u4FE1\u606F\uFF0C\u5177\u4F53\u6784\u9020\u5982\u4E0B\u56FE\u6240\u793A\uFF1A <img src="`+h+'" alt=""><strong>\u4F18\u52BF</strong>\uFF1A\u5F15\u7528\u4E2D\u5B58\u50A8\u7684\u662F<strong>\u7A33\u5B9A</strong>\u7684\u53E5\u67C4\u5730\u5740\uFF0C\u5728\u5BF9\u8C61\u88AB\u79FB\u52A8\uFF08\u5783\u573E\u6536\u96C6\u65F6\u79FB\u52A8\u5BF9\u8C61\u662F\u975E\u5E38\u666E\u904D\u7684\u884C\u4E3A\uFF09\u65F6\u53EA\u4F1A\u6539\u53D8<strong>\u53E5\u67C4</strong>\u4E2D\u7684<strong>\u5B9E\u4F8B\u6570\u636E\u6307\u9488</strong>\uFF0C\u800C<strong>\u5F15\u7528</strong>\u672C\u8EAB\u4E0D\u9700\u8981\u4FEE\u6539\u3002</p></li><li><p>\u76F4\u63A5\u6307\u9488 \u5982\u679C\u4F7F\u7528<strong>\u76F4\u63A5\u6307\u9488</strong>\u8BBF\u95EE\uFF0C<strong>\u5F15\u7528</strong>\u4E2D\u5B58\u50A8\u7684\u76F4\u63A5\u5C31\u662F<strong>\u5BF9\u8C61\u5730\u5740</strong>\uFF0C\u90A3\u4E48<code>Java</code>\u5806\u5BF9\u8C61\u5185\u90E8\u7684\u5E03\u5C40\u4E2D\u5C31\u5FC5\u987B\u8003\u8651\u5982\u4F55\u653E\u7F6E\u8BBF\u95EE<strong>\u7C7B\u578B\u6570\u636E</strong>\u7684\u76F8\u5173\u4FE1\u606F\u3002 <img src="'+f+'" alt=""><strong>\u4F18\u52BF</strong>\uFF1A\u901F\u5EA6\u66F4<strong>\u5FEB</strong>\uFF0C\u8282\u7701\u4E86<strong>\u4E00\u6B21\u6307\u9488\u5B9A\u4F4D</strong>\u7684\u65F6\u95F4\u5F00\u9500\u3002\u7531\u4E8E\u5BF9\u8C61\u7684\u8BBF\u95EE\u5728<code>Java</code>\u4E2D\u975E\u5E38\u9891\u7E41\uFF0C\u56E0\u6B64\u8FD9\u7C7B\u5F00\u9500\u79EF\u5C11\u6210\u591A\u540E\u4E5F\u662F\u975E\u5E38\u53EF\u89C2\u7684\u6267\u884C\u6210\u672C\u3002</p></li></ol><h3 id="\u5BF9\u8C61\u7684\u521D\u59CB\u5316" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u7684\u521D\u59CB\u5316" aria-hidden="true">#</a> \u5BF9\u8C61\u7684\u521D\u59CB\u5316</h3><p><strong>\u5BF9\u8C61\u7684\u521D\u59CB\u5316\u987A\u5E8F</strong> \u9759\u6001\u53D8\u91CF/\u9759\u6001\u4EE3\u7801\u5757 -&gt; \u666E\u901A\u4EE3\u7801\u5757 -&gt; \u6784\u9020\u51FD\u6570</p><ol><li>\u7236\u7C7B\u9759\u6001\u53D8\u91CF\u548C\u9759\u6001\u4EE3\u7801\u5757\uFF08\u5148\u58F0\u660E\u7684\u5148\u6267\u884C\uFF09\uFF1B</li><li>\u5B50\u7C7B\u9759\u6001\u53D8\u91CF\u548C\u9759\u6001\u4EE3\u7801\u5757\uFF08\u5148\u58F0\u660E\u7684\u5148\u6267\u884C\uFF09\uFF1B</li><li>\u7236\u7C7B\u666E\u901A\u6210\u5458\u53D8\u91CF\u548C\u666E\u901A\u4EE3\u7801\u5757\uFF08\u5148\u58F0\u660E\u7684\u5148\u6267\u884C\uFF09\uFF1B</li><li>\u7236\u7C7B\u7684\u6784\u9020\u51FD\u6570\uFF1B</li><li>\u5B50\u7C7B\u666E\u901A\u6210\u5458\u53D8\u91CF\u548C\u666E\u901A\u4EE3\u7801\u5757\uFF08\u5148\u58F0\u660E\u7684\u5148\u6267\u884C\uFF09\uFF1B</li><li>\u5B50\u7C7B\u7684\u6784\u9020\u51FD\u6570\u3002</li></ol><p><strong>\u793A\u4F8B</strong></p><p>Parent.java</p><p><img src="'+y+'" alt=""> Children.java</p><p><img src="'+S+'" alt=""> Tester.java</p><p><img src="'+w+'" alt=""></p><p>\u6D4B\u8BD5\u7ED3\u679C\uFF1A</p><p><img src="'+C+'" alt=""></p><h2 id="jvm\u5783\u573E\u56DE\u6536\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#jvm\u5783\u573E\u56DE\u6536\u7B97\u6CD5" aria-hidden="true">#</a> JVM\u5783\u573E\u56DE\u6536\u7B97\u6CD5</h2><h3 id="\u5BF9\u8C61\u751F\u6B7B\u5224\u5B9A" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u751F\u6B7B\u5224\u5B9A" aria-hidden="true">#</a> \u5BF9\u8C61\u751F\u6B7B\u5224\u5B9A</h3><ol><li><strong>\u5F15\u7528\u8BA1\u6570\u7B97\u6CD5</strong><code>Java</code> \u5806 \u4E2D\u6BCF\u4E2A\u5177\u4F53\u5BF9\u8C61\uFF08<strong>\u4E0D\u662F\u5F15\u7528</strong>\uFF09\u90FD\u6709\u4E00\u4E2A<strong>\u5F15\u7528\u8BA1\u6570\u5668</strong>\u3002\u5F53\u4E00\u4E2A\u5BF9\u8C61\u88AB\u521B\u5EFA\u5E76\u521D\u59CB\u5316\u8D4B\u503C\u540E\uFF0C\u8BE5\u53D8\u91CF\u8BA1\u6570\u8BBE\u7F6E\u4E3A1\u3002\u6BCF\u5F53\u6709\u4E00\u4E2A\u5730\u65B9\u5F15\u7528\u5B83\u65F6\uFF0C\u8BA1\u6570\u5668\u503C\u5C31<strong>\u52A01</strong>\u3002\u5F53\u5F15\u7528<strong>\u5931\u6548</strong>\u65F6\uFF0C\u5373\u4E00\u4E2A\u5BF9\u8C61\u7684\u67D0\u4E2A\u5F15\u7528\u8D85\u8FC7\u4E86\u751F\u547D\u5468\u671F\uFF08\u51FA\u4F5C\u7528\u57DF\u540E\uFF09\u6216\u8005\u88AB\u8BBE\u7F6E\u4E3A\u4E00\u4E2A\u65B0\u503C\u65F6\uFF0C\u8BA1\u6570\u5668\u503C\u5C31<strong>\u51CF1</strong>\u3002\u4EFB\u4F55\u5F15\u7528\u8BA1\u6570\u4E3A<code>0</code>\u7684\u5BF9\u8C61\u53EF\u4EE5\u88AB\u5F53\u4F5C\u5783\u573E\u6536\u96C6\u3002\u5F53\u4E00\u4E2A\u5BF9\u8C61\u88AB<strong>\u5783\u573E\u6536\u96C6</strong>\u65F6\uFF0C\u5B83\u5F15\u7528\u7684\u4EFB\u4F55\u5BF9\u8C61\u8BA1\u6570\u51CF1\u3002</li></ol><ul><li><p>\u4F18\u70B9</p><p>\u5F15\u7528\u8BA1\u6570\u6536\u96C6\u5668\u6267\u884C\u7B80\u5355\uFF0C\u5224\u5B9A\u6548\u7387\u9AD8\uFF0C\u4EA4\u7EC7\u5728\u7A0B\u5E8F\u8FD0\u884C\u4E2D\u3002\u5BF9\u7A0B\u5E8F\u4E0D\u88AB\u957F\u65F6\u95F4\u6253\u65AD\u7684\u5B9E\u65F6\u73AF\u5883\u6BD4\u8F83\u6709\u5229\u3002</p></li><li><p>\u7F3A\u70B9</p><p>\u96BE\u4EE5\u68C0\u6D4B\u51FA\u5BF9\u8C61\u4E4B\u95F4\u7684\u5FAA\u73AF\u5F15\u7528\u3002\u540C\u65F6\uFF0C\u5F15\u7528\u8BA1\u6570\u5668\u589E\u52A0\u4E86\u7A0B\u5E8F\u6267\u884C\u7684\u5F00\u9500\u3002\u6240\u4EE5Java\u8BED\u8A00\u5E76\u6CA1\u6709\u9009\u62E9\u8FD9\u79CD\u7B97\u6CD5\u8FDB\u884C\u5783\u573E\u56DE\u6536\u3002</p></li></ul><ol start="2"><li><strong>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5</strong><strong>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5</strong>\u4E5F\u53EB<strong>\u6839\u641C\u7D22\u7B97\u6CD5</strong>\uFF0C\u901A\u8FC7\u4E00\u7CFB\u5217\u7684\u79F0\u4E3A GC Roots \u7684\u5BF9\u8C61\u4F5C\u4E3A\u8D77\u70B9\uFF0C\u7136\u540E\u5411\u4E0B\u641C\u7D22\u3002\u641C\u7D22\u6240\u8D70\u8FC7\u7684\u8DEF\u5F84\u79F0\u4E3A\u5F15\u7528\u94FE \uFF08Reference Chain\uFF09\uFF0C \u5F53\u4E00\u4E2A<strong>\u5BF9\u8C61</strong>\u5230 GC Roots \u6CA1\u6709\u4EFB\u4F55<strong>\u5F15\u7528\u94FE</strong>\u76F8\u8FDE\u65F6, \u5373\u8BE5\u5BF9\u8C61<strong>\u4E0D\u53EF\u8FBE</strong>\uFF0C\u4E5F\u5C31\u8BF4\u660E\u6B64\u5BF9\u8C61\u662F <strong>\u4E0D\u53EF\u7528</strong>\u7684\u3002 \u5982\u4E0B\u56FE\u6240\u793A: <code>Object5</code>\u3001<code>Object6</code>\u3001<code>Object7 </code>\u867D\u7136\u4E92\u6709\u5173\u8054, \u4F46\u5B83\u4EEC\u5230<code>GC Roots</code>\u662F\u4E0D\u53EF\u8FBE\u7684, \u56E0\u6B64\u4E5F\u4F1A\u88AB\u5224\u5B9A\u4E3A\u53EF\u56DE\u6536\u7684\u5BF9\u8C61\u3002 <img src="'+j+'" alt=""></li></ol><p><strong>GC\u6839\u5BF9\u8C61</strong> \u5728<code>Java</code>\u4E2D, \u53EF\u4F5C\u4E3A<code>GC Roots</code>\u7684\u5BF9\u8C61\u5305\u62EC\u4EE5\u4E0B\u56DB\u79CD\uFF1A</p><ul><li><p><strong>\u865A\u62DF\u673A\u6808</strong>\uFF08\u6808\u5E27\u4E2D\u7684<strong>\u672C\u5730\u53D8\u91CF\u8868</strong>\uFF09\u4E2D\u5F15\u7528\u7684\u5BF9\u8C61</p></li><li><p><strong>\u672C\u5730\u65B9\u6CD5\u6808</strong> \u4E2D <code>JNI</code> \uFF08<code>Native</code>\u65B9\u6CD5\uFF09\u5F15\u7528\u7684\u53D8\u91CF</p></li><li><p><strong>\u65B9\u6CD5\u533A</strong> \u4E2D<strong>\u7C7B\u9759\u6001\u5C5E\u6027</strong>\u5F15\u7528\u7684\u53D8\u91CF</p></li><li><p><strong>\u65B9\u6CD5\u533A</strong> \u4E2D<strong>\u5E38\u91CF</strong>\u5F15\u7528\u7684\u53D8\u91CF</p><p>JVM\u4E2D\u7528\u5230\u7684\u6240\u6709\u73B0\u4EE3GC\u7B97\u6CD5\u5728\u56DE\u6536\u524D\u90FD\u4F1A\u5148\u627E\u51FA\u6240\u6709\u4ECD\u5B58\u6D3B\u7684\u5BF9\u8C61\u3002\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5\u662F\u4ECE\u79BB\u6563\u6570\u5B66\u4E2D\u7684\u56FE\u8BBA\u5F15\u5165\u7684\uFF0C\u7A0B\u5E8F\u628A\u6240\u6709\u7684\u5F15\u7528\u5173\u7CFB\u770B\u4F5C\u4E00\u5F20\u56FE\u3002\u4E0B\u56FE\u5C55\u793A\u7684JVM\u4E2D\u7684\u5185\u5B58\u5E03\u5C40\u53EF\u4EE5\u7528\u6765\u5F88\u597D\u5730\u9610\u91CA\u8FD9\u4E00\u6982\u5FF5\uFF1A <img src="'+M+'" alt=""></p></li></ul><h3 id="\u5BF9\u8C61\u5F15\u7528\u5206\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u5F15\u7528\u5206\u7C7B" aria-hidden="true">#</a> \u5BF9\u8C61\u5F15\u7528\u5206\u7C7B</h3><ol><li><strong>\u5F3A\u5F15\u7528(Strong Reference)</strong> \u5728\u4EE3\u7801\u4E2D\u666E\u904D\u5B58\u5728\u7684\uFF0C\u7C7B\u4F3C<code>Object obj = new Object()</code>\u8FD9\u7C7B\u5F15\u7528\uFF0C\u53EA\u8981\u5F3A\u5F15\u7528\u8FD8\u5728\uFF0C\u5783\u573E\u6536\u96C6\u5668\u6C38\u8FDC\u4E0D\u4F1A\u56DE\u6536\u6389\u88AB\u5F15\u7528\u7684\u5BF9\u8C61\u3002</li><li><strong>\u8F6F\u5F15\u7528(Sofe Reference)</strong><strong>\u6709\u7528\u4F46\u5E76\u975E\u5FC5\u9700</strong> \u7684\u5BF9\u8C61\uFF0C\u53EF\u7528<code>SoftReference</code>\u7C7B\u6765\u5B9E\u73B0\u8F6F\u5F15\u7528\u3002\u5728\u7CFB\u7EDF\u5C06\u8981\u53D1\u751F<code>\u5185\u5B58\u6EA2\u51FA\u5F02\u5E38</code>\u4E4B\u524D\uFF0C\u5C06\u4F1A\u628A\u8FD9\u4E9B\u5BF9\u8C61\u5217\u8FDB\u56DE\u6536\u8303\u56F4\u4E4B\u4E2D\u8FDB\u884C\u4E8C\u6B21\u56DE\u6536\u3002\u5982\u679C\u8FD9\u6B21\u56DE\u6536\u8FD8\u6CA1\u6709\u8DB3\u591F\u7684\u5185\u5B58\uFF0C\u624D\u4F1A\u629B\u51FA\u5185\u5B58\u6EA2\u51FA\u5F02\u5E38\u3002</li><li><strong>\u5F31\u5F15\u7528(Weak Reference)</strong><strong>\u975E\u5FC5</strong>\u9700 \u7684\u5BF9\u8C61\uFF0C\u4F46\u5B83\u7684<strong>\u5F3A\u5EA6</strong>\u6BD4\u8F6F\u5F15\u7528\u66F4\u5F31\uFF0C\u88AB\u5F31\u5F15\u7528\u5173\u8054\u7684\u5BF9\u8C61<strong>\u53EA\u80FD</strong>\u751F\u5B58\u5230\u4E0B\u4E00\u6B21\u5783\u573E\u6536\u96C6\u53D1\u751F\u4E4B\u524D\uFF0C<code>JDK</code>\u63D0\u4F9B\u4E86<code>WeakReference</code>\u7C7B\u6765\u5B9E\u73B0\u5F31\u5F15\u7528\u3002\u65E0\u8BBA\u5F53\u524D\u5185\u5B58\u662F\u5426\u8DB3\u591F\uFF0C\u7528\u8F6F\u5F15\u7528\u76F8\u5173\u8054\u7684\u5BF9\u8C61\u90FD\u4F1A\u88AB\u56DE\u6536\u6389\u3002</li><li><strong>\u865A\u5F15\u7528(Phantom Reference)</strong> \u865A\u5F15\u7528\u4E5F\u79F0\u4E3A\u5E7D\u7075\u5F15\u7528\u6216\u5E7B\u5F71\u5F15\u7528\uFF0C\u662F\u6700\u5F31\u7684\u4E00\u79CD\u5F15\u7528\u5173\u7CFB\uFF0C<code>JDK</code>\u63D0\u4F9B\u4E86<code>PhantomReference</code>\u7C7B\u6765\u5B9E\u73B0\u865A\u5F15\u7528\u3002\u4E3A\u4E00\u4E2A\u5BF9\u8C61\u8BBE\u7F6E\u865A\u5F15\u7528\u7684\u552F\u4E00\u76EE\u7684\u662F\uFF1A\u80FD\u5728\u8FD9\u4E2A\u5BF9\u8C61\u5728<strong>\u5783\u573E\u56DE\u6536\u5668</strong>\u56DE\u6536\u65F6\u6536\u5230\u4E00\u4E2A<strong>\u7CFB\u7EDF\u901A\u77E5</strong>\u3002</li></ol><h3 id="finalize-\u4E8C\u6B21\u6807\u8BB0" tabindex="-1"><a class="header-anchor" href="#finalize-\u4E8C\u6B21\u6807\u8BB0" aria-hidden="true">#</a> finalize()\u4E8C\u6B21\u6807\u8BB0</h3><p>\u4E00\u4E2A\u5BF9\u8C61\u662F\u5426\u5E94\u8BE5\u5728\u5783\u573E\u56DE\u6536\u5668\u5728GC\u65F6\u56DE\u6536\uFF0C\u81F3\u5C11\u8981\u7ECF\u5386<strong>\u4E24\u6B21\u6807\u8BB0\u8FC7\u7A0B</strong>\u3002</p><p>\u7B2C\u4E00\u6B21\u6807\u8BB0\u8FC7\u7A0B\uFF0C\u901A\u8FC7<strong>\u53EF\u8FBE\u6027\u5206\u6790\u7B97\u6CD5</strong>\u5206\u6790\u5BF9\u8C61\u662F\u5426\u4E0E<code>GC Roots</code>\u53EF\u8FBE\u3002\u7ECF\u8FC7\u7B2C\u4E00\u6B21\u6807\u8BB0\uFF0C\u5E76\u4E14\u88AB\u7B5B\u9009\u4E3A<strong>\u4E0D\u53EF\u8FBE</strong>\u7684\u5BF9\u8C61\u4F1A\u8FDB\u884C\u7B2C\u4E8C\u6B21\u6807\u8BB0\u3002</p><p>\u7B2C\u4E8C\u6B21\u6807\u8BB0\u8FC7\u7A0B\uFF0C\u5224\u65AD\u4E0D\u53EF\u8FBE\u5BF9\u8C61\u662F\u5426\u6709\u5FC5\u8981\u6267\u884C<code>finalize</code>\u65B9\u6CD5\u3002\u6267\u884C\u6761\u4EF6\u662F\u5F53\u524D\u5BF9\u8C61\u7684<code>finalize</code>\u65B9\u6CD5\u88AB\u91CD\u5199\uFF0C\u5E76\u4E14\u8FD8\u672A\u88AB\u7CFB\u7EDF\u8C03\u7528\u8FC7\u3002\u5982\u679C\u5141\u8BB8\u6267\u884C\u90A3\u4E48\u8FD9\u4E2A\u5BF9\u8C61\u5C06\u4F1A\u88AB\u653E\u5230\u4E00\u4E2A\u53EB<code>F-Query</code>\u7684\u961F\u5217\u4E2D\uFF0C\u7B49\u5F85\u88AB\u6267\u884C\u3002</p><div class="custom-container tip"><p class="custom-container-title">\u6CE8\u610F</p><p>\u7531\u4E8E<code>finalize</code>\u7531\u4E00\u4E2A\u4F18\u5148\u7EA7\u6BD4\u8F83\u4F4E\u7684<code>Finalizer</code>\u7EBF\u7A0B\u8FD0\u884C\uFF0C\u6240\u4EE5\u8BE5\u5BF9\u8C61\u7684\u7684<code>finalize</code>\u65B9\u6CD5\u4E0D\u4E00\u5B9A\u88AB\u6267\u884C\uFF0C\u5373\u4F7F\u88AB\u6267\u884C\u4E86\uFF0C\u4E5F\u4E0D\u4FDD\u8BC1<code>finalize</code>\u65B9\u6CD5\u4E00\u5B9A\u4F1A\u6267\u884C\u5B8C\u3002\u5982\u679C\u5BF9\u8C61\u7B2C\u4E8C\u6B21\u5C0F\u89C4\u6A21\u6807\u8BB0\uFF0C\u5373<code>finalize</code>\u65B9\u6CD5\u4E2D\u62EF\u6551\u81EA\u5DF1\uFF0C\u53EA\u9700\u8981\u91CD\u65B0\u548C\u5F15\u7528\u94FE\u4E0A\u7684\u4EFB\u4E00\u5BF9\u8C61\u5EFA\u7ACB\u5173\u8054\u5373\u53EF\u3002</p></div><h3 id="\u5783\u573E\u56DE\u6536\u7B97\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u7B97\u6CD5" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u7B97\u6CD5</h3><ol><li><strong>\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5</strong> \u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5\u5BF9<strong>\u6839\u96C6\u5408</strong>\u8FDB\u884C\u626B\u63CF\uFF0C\u5BF9\u5B58\u6D3B\u7684\u5BF9\u8C61\u8FDB\u884C\u6807\u8BB0\u3002\u6807\u8BB0\u5B8C\u6210\u540E\uFF0C\u518D\u5BF9\u6574\u4E2A\u7A7A\u95F4\u5185<strong>\u672A\u88AB\u6807\u8BB0</strong>\u7684\u5BF9\u8C61\u626B\u63CF\uFF0C\u8FDB\u884C\u56DE\u6536\u3002</li></ol><ul><li><p><strong>\u4F18\u70B9\uFF1A</strong></p><p>\u5B9E\u73B0\u7B80\u5355\uFF0C\u4E0D\u9700\u8981\u8FDB\u884C\u5BF9\u8C61\u8FDB\u884C\u79FB\u52A8\u3002</p></li><li><p><strong>\u7F3A\u70B9\uFF1A</strong></p><p>\u6807\u8BB0\u3001\u6E05\u9664\u8FC7\u7A0B\u6548\u7387\u4F4E\uFF0C\u4EA7\u751F\u5927\u91CF\u4E0D\u8FDE\u7EED\u7684\u5185\u5B58\u788E\u7247\uFF0C\u63D0\u9AD8\u4E86\u5783\u573E\u56DE\u6536\u7684\u9891\u7387\u3002</p></li></ul><ol start="2"><li><strong>\u590D\u5236\u7B97\u6CD5</strong> \u8FD9\u79CD\u6536\u96C6\u7B97\u6CD5\u89E3\u51B3\u4E86\u6807\u8BB0\u6E05\u9664\u7B97\u6CD5\u5B58\u5728\u7684\u6548\u7387\u95EE\u9898\u3002\u5B83\u5C06\u5185\u5B58\u533A\u57DF\u5212\u5206\u6210\u76F8\u540C\u7684\u4E24\u4E2A<strong>\u5185\u5B58\u5757</strong>\u3002\u6BCF\u6B21\u4EC5\u4F7F\u7528\u4E00\u534A\u7684\u7A7A\u95F4\uFF0C<code>JVM</code>\u751F\u6210\u7684\u65B0\u5BF9\u8C61\u653E\u5728\u4E00\u534A\u7A7A\u95F4\u4E2D\u3002\u5F53\u4E00\u534A\u7A7A\u95F4\u7528\u5B8C\u65F6\u8FDB\u884C<code>GC</code>\uFF0C\u628A\u53EF\u5230\u8FBE\u5BF9\u8C61\u590D\u5236\u5230\u53E6\u4E00\u534A\u7A7A\u95F4\uFF0C\u7136\u540E\u628A\u4F7F\u7528\u8FC7\u7684\u5185\u5B58\u7A7A\u95F4\u4E00\u6B21\u6E05\u7406\u6389\u3002</li></ol><ul><li><p><strong>\u4F18\u70B9\uFF1A</strong></p><p>\u6309\u987A\u5E8F\u5206\u914D\u5185\u5B58\u5373\u53EF\uFF0C\u5B9E\u73B0\u7B80\u5355\u3001\u8FD0\u884C\u9AD8\u6548\uFF0C\u4E0D\u7528\u8003\u8651\u5185\u5B58\u788E\u7247\u3002</p></li><li><p><strong>\u7F3A\u70B9\uFF1A</strong></p><p>\u53EF\u7528\u7684\u5185\u5B58\u5927\u5C0F\u7F29\u5C0F\u4E3A\u539F\u6765\u7684\u4E00\u534A\uFF0C\u5BF9\u8C61\u5B58\u6D3B\u7387\u9AD8\u65F6\u4F1A\u9891\u7E41\u8FDB\u884C\u590D\u5236\u3002</p></li></ul><ol start="3"><li><strong>\u6807\u8BB0-\u6574\u7406\u7B97\u6CD5</strong></li></ol><ul><li><p><strong>\u4F18\u70B9\uFF1A</strong></p><p>\u89E3\u51B3\u4E86\u6807\u8BB0-\u6E05\u7406\u7B97\u6CD5\u5B58\u5728\u7684\u5185\u5B58\u788E\u7247\u95EE\u9898\u3002</p></li><li><p><strong>\u7F3A\u70B9\uFF1A</strong></p><p>\u4ECD\u9700\u8981\u8FDB\u884C\u5C40\u90E8\u5BF9\u8C61\u79FB\u52A8\uFF0C\u4E00\u5B9A\u7A0B\u5EA6\u4E0A\u964D\u4F4E\u4E86\u6548\u7387\u3002</p></li></ul><ol start="4"><li><strong>\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5</strong> \u5F53\u524D\u5546\u4E1A\u865A\u62DF\u673A\u90FD\u91C7\u7528<strong>\u5206\u4EE3\u6536\u96C6</strong>\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5\u3002\u5206\u4EE3\u6536\u96C6\u7B97\u6CD5\uFF0C\u987E\u540D\u601D\u4E49\u662F\u6839\u636E\u5BF9\u8C61\u7684<strong>\u5B58\u6D3B\u5468\u671F</strong>\u5C06\u5185\u5B58\u5212\u5206\u4E3A\u51E0\u5757\u3002\u4E00\u822C\u5305\u62EC<strong>\u5E74\u8F7B\u4EE3</strong>\u3001<strong>\u8001\u5E74\u4EE3</strong> \u548C <strong>\u6C38\u4E45\u4EE3</strong>\uFF0C\u5982\u56FE\u6240\u793A\uFF1A <img src="'+x+`" alt=""></li></ol><p><strong>\u65B0\u751F\u4EE3\uFF08Young generation\uFF09</strong></p><p>\u7EDD\u5927\u591A\u6570\u6700\u65B0\u88AB\u521B\u5EFA\u7684\u5BF9\u8C61\u4F1A\u88AB\u5206\u914D\u5230\u8FD9\u91CC\uFF0C\u7531\u4E8E<strong>\u5927\u90E8\u5206\u5BF9\u8C61</strong>\u5728\u521B\u5EFA\u540E\u4F1A\u5F88\u5FEB\u53D8\u5F97<strong>\u4E0D\u53EF\u8FBE</strong>\uFF0C\u6240\u4EE5\u5F88\u591A\u5BF9\u8C61\u88AB\u521B\u5EFA\u5728<strong>\u65B0\u751F\u4EE3</strong>\uFF0C\u7136\u540E<strong>\u6D88\u5931</strong>\u3002\u5BF9\u8C61\u4ECE\u8FD9\u4E2A\u533A\u57DF\u6D88\u5931\u7684\u8FC7\u7A0B\u6211\u4EEC\u79F0\u4E4B\u4E3A <code>minor GC</code>\u3002</p><p><strong>\u65B0\u751F\u4EE3</strong> \u4E2D\u5B58\u5728\u4E00\u4E2A<code>Eden</code>\u533A\u548C\u4E24\u4E2A<code>Survivor</code>\u533A\u3002\u65B0\u5BF9\u8C61\u4F1A\u9996\u5148\u5206\u914D\u5728<code>Eden</code>\u4E2D\uFF08\u5982\u679C\u65B0\u5BF9\u8C61\u8FC7\u5927\uFF0C\u4F1A\u76F4\u63A5\u5206\u914D\u5728\u8001\u5E74\u4EE3\u4E2D\uFF09\u3002\u5728<code>GC</code>\u4E2D\uFF0C<code>Eden</code>\u4E2D\u7684\u5BF9\u8C61\u4F1A\u88AB\u79FB\u52A8\u5230<code>Survivor</code>\u4E2D\uFF0C\u76F4\u81F3\u5BF9\u8C61\u6EE1\u8DB3\u4E00\u5B9A\u7684\u5E74\u7EAA\uFF08\u5B9A\u4E49\u4E3A\u71AC\u8FC7<code>GC</code>\u7684\u6B21\u6570\uFF09\uFF0C\u4F1A\u88AB\u79FB\u52A8\u5230<strong>\u8001\u5E74\u4EE3</strong>\u3002</p><p>\u53EF\u4EE5\u8BBE\u7F6E<strong>\u65B0\u751F\u4EE3</strong>\u548C<strong>\u8001\u5E74\u4EE3</strong>\u7684\u76F8\u5BF9\u5927\u5C0F\u3002\u8FD9\u79CD\u65B9\u5F0F\u7684\u4F18\u70B9\u662F\u65B0\u751F\u4EE3\u5927\u5C0F\u4F1A\u968F\u7740\u6574\u4E2A<strong>\u5806</strong>\u5927\u5C0F<strong>\u52A8\u6001\u6269\u5C55</strong>\u3002\u53C2\u6570 <code>-XX:NewRatio</code> \u8BBE\u7F6E<strong>\u8001\u5E74\u4EE3</strong>\u4E0E<strong>\u65B0\u751F\u4EE3</strong>\u7684\u6BD4\u4F8B\u3002\u4F8B\u5982 <code>-XX:NewRatio=8</code> \u6307\u5B9A <strong>\u8001\u5E74\u4EE3/\u65B0\u751F\u4EE3</strong> \u4E3A<code>8/1</code>. <strong>\u8001\u5E74\u4EE3</strong> \u5360\u5806\u5927\u5C0F\u7684 <code>7/8</code> \uFF0C<strong>\u65B0\u751F\u4EE3</strong> \u5360\u5806\u5927\u5C0F\u7684 <code>1/8</code>\uFF08\u9ED8\u8BA4\u5373\u662F <code>1/8</code>\uFF09\u3002</p><p>\u4F8B\u5982\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>-XX:NewSize=64m -XX:MaxNewSize=1024m -XX:NewRatio=8
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u8001\u5E74\u4EE3\uFF08Old generation\uFF09</strong></p><p>\u5BF9\u8C61\u6CA1\u6709\u53D8\u5F97\u4E0D\u53EF\u8FBE\uFF0C\u5E76\u4E14\u4ECE\u65B0\u751F\u4EE3\u4E2D<strong>\u5B58\u6D3B</strong>\u4E0B\u6765\uFF0C\u4F1A\u88AB<strong>\u62F7\u8D1D</strong>\u5230\u8FD9\u91CC\u3002\u5176\u6240\u5360\u7528\u7684\u7A7A\u95F4\u8981\u6BD4\u65B0\u751F\u4EE3\u591A\u3002\u4E5F\u6B63\u7531\u4E8E\u5176\u76F8\u5BF9<strong>\u8F83\u5927\u7684\u7A7A\u95F4</strong>\uFF0C\u53D1\u751F\u5728<strong>\u8001\u5E74\u4EE3</strong>\u4E0A\u7684<code>GC</code>\u8981\u6BD4<strong>\u65B0\u751F\u4EE3</strong>\u8981<strong>\u5C11\u5F97\u591A</strong>\u3002\u5BF9\u8C61\u4ECE<strong>\u8001\u5E74\u4EE3</strong>\u4E2D\u6D88\u5931\u7684\u8FC7\u7A0B\uFF0C\u53EF\u4EE5\u79F0\u4E4B\u4E3A<code>major GC</code>\uFF08\u6216\u8005<code>full GC</code>\uFF09\u3002</p><p><strong>\u6C38\u4E45\u4EE3\uFF08permanent generation</strong></p><p>\u50CF\u4E00\u4E9B<strong>\u7C7B\u7684\u5C42\u7EA7\u4FE1\u606F</strong>\uFF0C<strong>\u65B9\u6CD5\u6570\u636E</strong> \u548C<strong>\u65B9\u6CD5\u4FE1\u606F</strong>\uFF08\u5982<strong>\u5B57\u8282\u7801</strong>\uFF0C<strong>\u6808</strong> \u548C <strong>\u53D8\u91CF\u5927\u5C0F</strong>\uFF09\uFF0C<strong>\u8FD0\u884C\u65F6\u5E38\u91CF\u6C60</strong>\uFF08<code>JDK7</code>\u4E4B\u540E\u79FB\u51FA<strong>\u6C38\u4E45\u4EE3</strong>\uFF09\uFF0C\u5DF2\u786E\u5B9A\u7684<strong>\u7B26\u53F7\u5F15\u7528</strong>\u548C<strong>\u865A\u65B9\u6CD5\u8868</strong>\u7B49\u7B49\u3002\u5B83\u4EEC\u51E0\u4E4E\u90FD\u662F<strong>\u9759\u6001\u7684</strong>\u5E76\u4E14<strong>\u5F88\u5C11</strong>\u88AB<strong>\u5378\u8F7D</strong>\u548C<strong>\u56DE\u6536</strong>\uFF0C\u5728<code>JDK8</code>\u4E4B\u524D\u7684<code>HotSpot</code>\u865A\u62DF\u673A\u4E2D\uFF0C\u7C7B\u7684\u8FD9\u4E9B\u201C<strong>\u6C38\u4E45\u7684</strong>\u201D\u6570\u636E\u5B58\u653E\u5728\u4E00\u4E2A\u53EB\u505A<strong>\u6C38\u4E45\u4EE3</strong>\u7684\u533A\u57DF\u3002</p><p>\u6C38\u4E45\u4EE3\u4E00\u6BB5<strong>\u8FDE\u7EED\u7684\u5185\u5B58\u7A7A\u95F4</strong>\uFF0C\u6211\u4EEC\u5728<code>JVM</code>\u542F\u52A8\u4E4B\u524D\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6E<code>-XX:MaxPermSize</code>\u7684\u503C\u6765\u63A7\u5236\u6C38\u4E45\u4EE3\u7684\u5927\u5C0F\u3002\u4F46\u662F<code>JDK8</code>\u4E4B\u540E\u53D6\u6D88\u4E86\u6C38\u4E45\u4EE3\uFF0C\u8FD9\u4E9B<strong>\u5143\u6570\u636E</strong>\u88AB\u79FB\u5230\u4E86\u4E00\u4E2A\u4E0E\u5806<strong>\u4E0D\u76F8\u8FDE</strong>\u7684\u79F0\u4E3A<strong>\u5143\u7A7A\u95F4</strong> (<code>Metaspac</code>e) \u7684<strong>\u672C\u5730\u5185\u5B58\u533A\u57DF</strong>\u3002</p><p><strong>\u603B\u7ED3</strong></p><p><code>JDK8</code>\u5806\u5185\u5B58\u4E00\u822C\u662F\u5212\u5206\u4E3A<strong>\u5E74\u8F7B\u4EE3</strong>\u548C<strong>\u8001\u5E74\u4EE3</strong>\uFF0C<strong>\u4E0D\u540C\u5E74\u4EE3</strong> \u6839\u636E\u81EA\u8EAB\u7279\u6027\u91C7\u7528<strong>\u4E0D\u540C\u7684\u5783\u573E\u6536\u96C6\u7B97\u6CD5</strong>\u3002</p><p>\u5BF9\u4E8E<strong>\u65B0\u751F\u4EE3</strong>\uFF0C\u6BCF\u6B21<code>GC</code>\u65F6\u90FD\u6709<strong>\u5927\u91CF</strong>\u7684\u5BF9\u8C61\u6B7B\u4EA1\uFF0C\u53EA\u6709<strong>\u5C11\u91CF</strong>\u5BF9\u8C61\u5B58\u6D3B\u3002\u8003\u8651\u5230\u590D\u5236\u6210\u672C\u4F4E\uFF0C\u9002\u5408\u91C7\u7528<strong>\u590D\u5236\u7B97\u6CD5</strong>\u3002\u56E0\u6B64\u6709\u4E86<code>From Survivor</code>\u548C<code>To Survivor</code>\u533A\u57DF\u3002</p><p>\u5BF9\u4E8E<strong>\u8001\u5E74\u4EE3</strong>\uFF0C\u56E0\u4E3A\u5BF9\u8C61<strong>\u5B58\u6D3B\u7387\u9AD8</strong>\uFF0C\u6CA1\u6709\u989D\u5916\u7684\u5185\u5B58\u7A7A\u95F4\u5BF9\u5B83\u8FDB\u884C\u62C5\u4FDD\u3002\u56E0\u800C\u9002\u5408\u91C7\u7528<strong>\u6807\u8BB0-\u6E05\u7406\u7B97\u6CD5</strong>\u548C<strong>\u6807\u8BB0-\u6574\u7406\u7B97\u6CD5</strong>\u8FDB\u884C\u56DE\u6536\u3002</p><h2 id="\u5783\u573E\u56DE\u6536\u5668" tabindex="-1"><a class="header-anchor" href="#\u5783\u573E\u56DE\u6536\u5668" aria-hidden="true">#</a> \u5783\u573E\u56DE\u6536\u5668</h2><ol><li><p>\u5783\u573E\u56DE\u6536\u5668\u5206\u7C7B\u6807\u51C6 <img src="`+E+'" alt=""></p></li><li><p>\u4E03\u79CD\u5783\u573E\u56DE\u6536\u5668\u6982\u8FF0 \u5728 <code>JVM</code> \u4E2D\uFF0C\u5177\u4F53\u5B9E\u73B0\u6709 <code>Serial</code>\u3001<code>ParNew</code>\u3001<code>Parallel Scavenge</code>\u3001<code>CMS</code>\u3001<code>Serial Old\uFF08MSC\uFF09</code>\u3001<code>Parallel Old</code>\u3001<code>G1</code> \u7B49\u3002\u5728\u4E0B\u56FE\u4E2D\uFF0C\u4F60\u53EF\u4EE5\u770B\u5230 <strong>\u4E0D\u540C\u5783\u573E\u56DE\u6536\u5668</strong> \u9002\u5408\u4E8E <strong>\u4E0D\u540C\u7684\u5185\u5B58\u533A\u57DF</strong>\uFF0C\u5982\u679C\u4E24\u4E2A\u5783\u573E\u56DE\u6536\u5668\u4E4B\u95F4 <strong>\u5B58\u5728\u8FDE\u7EBF</strong>\uFF0C\u90A3\u4E48\u8868\u793A\u4E24\u8005\u53EF\u4EE5 <strong>\u914D\u5408\u4F7F\u7528</strong>\u3002</p></li></ol><p>\u5982\u679C\u5F53 <strong>\u5783\u573E\u56DE\u6536\u5668</strong> \u8FDB\u884C\u5783\u573E\u6E05\u7406\u65F6\uFF0C\u5FC5\u987B <strong>\u6682\u505C</strong> \u5176\u4ED6\u6240\u6709\u7684 <strong>\u5DE5\u4F5C\u7EBF\u7A0B</strong>\uFF0C\u76F4\u5230\u5B83\u5B8C\u5168\u6536\u96C6\u7ED3\u675F\u3002\u6211\u4EEC\u79F0\u8FD9\u79CD\u9700\u8981\u6682\u505C\u5DE5\u4F5C\u7EBF\u7A0B\u624D\u80FD\u8FDB\u884C\u6E05\u7406\u7684\u7B56\u7565\u4E3A <code>Stop-the-World</code>\u3002\u4EE5\u4E0A\u56DE\u6536\u5668\u4E2D\uFF0C <code>Serial\u3001ParNew</code>\u3001<code>Parallel Scavenge</code>\u3001<code>Serial Old</code>\u3001<code>Parallel Old</code> \u5747\u91C7\u7528\u7684\u662F <code>Stop-the-World</code> \u7684\u7B56\u7565\u3002 <img src="'+O+'" alt=""></p><p>\u56FE\u4E2D\u6709 <code>7 </code>\u79CD\u4E0D\u540C\u7684 <strong>\u5783\u573E\u56DE\u6536\u5668</strong>\uFF0C\u5B83\u4EEC\u5206\u522B\u7528\u4E8E\u4E0D\u540C\u5206\u4EE3\u7684\u5783\u573E\u56DE\u6536\u3002</p><ul><li><strong>\u65B0\u751F\u4EE3\u56DE\u6536\u5668</strong>\uFF1ASerial\u3001ParNew\u3001Parallel Scavenge</li><li><strong>\u8001\u5E74\u4EE3\u56DE\u6536\u5668</strong>\uFF1ASerial Old\u3001Parallel Old\u3001CMS</li><li><strong>\u6574\u5806\u56DE\u6536\u5668</strong>\uFF1AG1 \u4E24\u4E2A <strong>\u5783\u573E\u56DE\u6536\u5668</strong> \u4E4B\u95F4\u6709\u8FDE\u7EBF\u8868\u793A\u5B83\u4EEC\u53EF\u4EE5 <strong>\u642D\u914D\u4F7F\u7528</strong>\uFF0C\u53EF\u9009\u7684\u642D\u914D\u65B9\u6848\u5982\u4E0B\uFF1A</li></ul><table><thead><tr><th><strong>\u65B0\u751F\u4EE3</strong></th><th><strong>\u8001\u5E74\u4EE3</strong></th></tr></thead><tbody><tr><td>Serial</td><td>Serial Old</td></tr><tr><td>Serial</td><td>CMS</td></tr><tr><td>ParNew</td><td>Serial Old</td></tr><tr><td>ParNew</td><td>CMS</td></tr><tr><td>Parallel Scavenge</td><td>Serial Old</td></tr><tr><td>Parallel Scavenge</td><td>Parallel Old</td></tr><tr><td>G1</td><td>G1</td></tr></tbody></table><ol start="3"><li><strong>\u5355\u7EBF\u7A0B\u5783\u573E\u56DE\u6536\u5668</strong></li></ol><p><strong>3.1 Serial\uFF08-XX:+UseSerialGC\uFF09</strong><code>Serial</code> \u56DE\u6536\u5668\u662F\u6700\u57FA\u672C\u7684 <strong>\u65B0\u751F\u4EE3</strong> \u5783\u573E\u56DE\u6536\u5668\uFF0C\u662F <strong>\u5355\u7EBF\u7A0B</strong> \u7684\u5783\u573E\u56DE\u6536\u5668\u3002\u7531\u4E8E\u5783\u573E\u6E05\u7406\u65F6\uFF0C<code>Serial</code> <strong>\u56DE\u6536\u5668</strong> \u4E0D\u5B58\u5728 <strong>\u7EBF\u7A0B\u95F4\u7684\u5207\u6362</strong>\uFF0C\u56E0\u6B64\uFF0C\u7279\u522B\u662F\u5728\u5355 <code>CPU</code> \u7684\u73AF\u5883\u4E0B\uFF0C\u5B83\u7684 <strong>\u5783\u573E\u6E05\u9664\u6548\u7387</strong> \u6BD4\u8F83\u9AD8\u3002\u5BF9\u4E8E <code>Client</code> \u8FD0\u884C\u6A21\u5F0F\u7684\u7A0B\u5E8F\uFF0C\u9009\u62E9 <code>Serial</code> \u56DE\u6536\u5668\u662F\u4E00\u4E2A\u4E0D\u9519\u7684\u9009\u62E9\u3002</p><blockquote><p><code>Serial</code> <strong>\u65B0\u751F\u4EE3\u56DE\u6536\u5668</strong> \u91C7\u7528\u7684\u662F <strong>\u590D\u5236\u7B97\u6CD5</strong>\u3002</p></blockquote><p><strong>3.2. Serial Old\uFF08-XX:+UseSerialGC\uFF09</strong><code>Serial Old</code> \u56DE\u6536\u5668\u662F <code>Serial</code> \u56DE\u6536\u5668\u7684 <strong>\u8001\u751F\u4EE3\u7248\u672C</strong>\uFF0C\u5C5E\u4E8E <strong>\u5355\u7EBF\u7A0B\u56DE\u6536\u5668</strong>\u3002\u5BF9\u4E8E <code>Server</code> \u6A21\u5F0F\u4E0B\u7684\u865A\u62DF\u673A\uFF0C\u5728 <code>JDK1.5</code> \u53CA\u5176\u4EE5\u524D\uFF0C\u5B83\u5E38\u4E0E <code>Parallel Scavenge</code> \u56DE\u6536\u5668\u914D\u5408\u4F7F\u7528\uFF0C\u8FBE\u5230\u8F83\u597D\u7684 <strong>\u541E\u5410\u91CF</strong>\uFF0C\u53E6\u5916\u5B83\u4E5F\u662F <code>CMS</code> \u56DE\u6536\u5668\u5728 <code>Concurrent Mode Failure</code> \u65F6\u7684 <strong>\u540E\u5907\u65B9\u6848</strong>\u3002</p><blockquote><p><code>Serial Old</code> <strong>\u8001\u5E74\u4EE3\u56DE\u6536\u5668</strong> \u91C7\u7528\u7684\u662F <strong>\u6807\u8BB0 - \u6574\u7406\u7B97\u6CD5</strong>\u3002</p></blockquote><ol start="4"><li><strong>\u591A\u7EBF\u7A0B\u5783\u573E\u56DE\u6536\u5668\uFF08\u541E\u5410\u91CF\u4F18\u5148\uFF09</strong></li></ol><p><strong>4.1. ParNew\uFF08-XX:+UseParNewGC\uFF09</strong></p><p><code>ParNew</code> \u56DE\u6536\u5668\u662F\u5728 <code>Serial</code> \u56DE\u6536\u5668\u7684\u57FA\u7840\u4E0A\u6F14\u5316\u800C\u6765\u7684\uFF0C\u5C5E\u4E8E <code>Serial</code> \u56DE\u6536\u5668\u7684 <strong>\u591A\u7EBF\u7A0B\u7248\u672C</strong>\uFF0C\u540C\u6837\u8FD0\u884C\u5728 <strong>\u65B0\u751F\u4EE3\u533A\u57DF</strong>\u3002\u5728\u5B9E\u73B0\u4E0A\uFF0C\u4E24\u8005\u5171\u7528\u5F88\u591A\u4EE3\u7801\u3002\u5728\u4E0D\u540C\u8FD0\u884C\u73AF\u5883\u4E0B\uFF0C\u6839\u636E <code>CPU</code> \u6838\u6570\uFF0C\u5F00\u542F <strong>\u4E0D\u540C\u7684\u7EBF\u7A0B\u6570</strong>\uFF0C\u4ECE\u800C\u8FBE\u5230 <strong>\u6700\u4F18</strong> \u7684\u5783\u573E\u56DE\u6536\u6548\u679C\u3002\u5BF9\u4E8E\u90A3\u4E9B <code>Server</code> \u6A21\u5F0F\u7684\u5E94\u7528\u7A0B\u5E8F\uFF0C\u5982\u679C\u8003\u8651\u91C7\u7528 CMS \u4F5C\u4E3A <strong>\u8001\u751F\u4EE3\u56DE\u6536\u5668</strong> \u65F6\uFF0C<code>ParNew</code> \u56DE\u6536\u5668\u662F\u4E00\u4E2A\u4E0D\u9519\u7684\u9009\u62E9\u3002 <img src="'+J+'" alt=""></p><blockquote><p><code>ParNew</code> <strong>\u65B0\u751F\u4EE3\u56DE\u6536\u5668</strong> \u91C7\u7528\u7684\u662F <strong>\u590D\u5236\u7B97\u6CD5</strong>\u3002</p></blockquote><p><strong>4.2. Parallel Scavenge\uFF08-XX:+UseParallelGC\uFF09</strong></p><p>\u548C <code>ParNew</code> \u56DE\u6536\u4E00\u6837\uFF0C<code>Parallel Scavenge</code> \u56DE\u6536\u5668\u4E5F\u662F\u8FD0\u884C\u5728 **\u65B0\u751F\u4EE3\u533A\u57DF\uFF0C**\u5C5E\u4E8E <strong>\u591A\u7EBF\u7A0B</strong> \u7684\u56DE\u6536\u5668\u3002\u4F46\u4E0D\u540C\u7684\u662F\uFF0C<code>ParNew</code> \u56DE\u6536\u5668\u662F\u901A\u8FC7\u63A7\u5236 <strong>\u5783\u573E\u56DE\u6536</strong> \u7684 <strong>\u7EBF\u7A0B\u6570</strong> \u6765\u8FDB\u884C\u53C2\u6570\u8C03\u6574\uFF0C\u800C <code>Parallel Scavenge</code> \u56DE\u6536\u5668\u66F4\u5173\u5FC3\u7684\u662F <strong>\u7A0B\u5E8F\u8FD0\u884C\u7684\u541E\u5410\u91CF</strong>\u3002\u5373\u4E00\u6BB5\u65F6\u95F4\u5185\uFF0C<strong>\u7528\u6237\u4EE3\u7801</strong> \u8FD0\u884C\u65F6\u95F4\u5360 <strong>\u603B\u8FD0\u884C\u65F6\u95F4</strong> \u7684\u767E\u5206\u6BD4\u3002</p><blockquote><p><code>Parallel Scavenge</code> <strong>\u65B0\u751F\u4EE3\u56DE\u6536\u5668</strong> \u91C7\u7528\u7684\u662F <strong>\u590D\u5236\u7B97\u6CD5</strong>\u3002</p></blockquote><p><strong>4.3. Parallel Old\uFF08-XX:+UseParallelOldGC\uFF09</strong></p><p><code>Parallel Old</code> \u56DE\u6536\u5668\u662F <code>Parallel Scavenge</code> \u56DE\u6536\u5668\u7684 <strong>\u8001\u751F\u4EE3\u7248\u672C</strong>\uFF0C\u5C5E\u4E8E <strong>\u591A\u7EBF\u7A0B\u56DE\u6536\u5668</strong>\u3002<code>Parallel Old</code> \u56DE\u6536\u5668\u548C <code>Parallel Scavenge</code> \u56DE\u6536\u5668\u540C\u6837\u8003\u8651\u4E86 <strong>\u541E\u5410\u91CF\u4F18\u5148</strong> \u8FD9\u4E00\u6307\u6807\uFF0C\u975E\u5E38\u9002\u5408\u90A3\u4E9B <strong>\u6CE8\u91CD\u541E\u5410\u91CF</strong> \u548C <code>CPU</code> <strong>\u8D44\u6E90\u654F\u611F</strong> \u7684\u573A\u5408\u3002 <img src="'+_+'" alt=""></p><blockquote><p><code>Parallel Old</code> <strong>\u8001\u5E74\u4EE3\u56DE\u6536\u5668</strong> \u91C7\u7528\u7684\u662F <strong>\u6807\u8BB0 - \u6574\u7406\u7B97\u6CD5</strong>\u3002</p></blockquote><ol start="5"><li><strong>\u5176\u4ED6\u7684\u56DE\u6536\u5668\uFF08\u505C\u987F\u65F6\u95F4\u4F18\u5148\uFF09</strong></li></ol><p><strong>5.1. CMS\uFF08-XX:+UseConcMarkSweepGC\uFF09</strong><code>CMS\uFF08Concurrent Mark Sweep\uFF09</code> \u56DE\u6536\u5668\u662F\u5728 <strong>\u6700\u77ED\u56DE\u6536\u505C\u987F\u65F6\u95F4</strong> \u4E3A\u524D\u63D0\u7684\u56DE\u6536\u5668\uFF0C\u5C5E\u4E8E **\u591A\u7EBF\u7A0B\u56DE\u6536\u5668\uFF0C**\u91C7\u7528 <strong>\u6807\u8BB0-\u6E05\u9664\u7B97\u6CD5</strong>\u3002 <img src="'+q+'" alt=""> \u76F8\u6BD4\u4E4B\u524D\u7684\u56DE\u6536\u5668\uFF0C<code>CMS</code> \u56DE\u6536\u5668\u7684\u8FD0\u4F5C\u8FC7\u7A0B\u6BD4\u8F83\u590D\u6742\uFF0C\u5206\u4E3A\u56DB\u6B65\uFF1A</p><ol><li><strong>\u521D\u59CB\u6807\u8BB0\uFF08CMS initial mark\uFF09</strong></li></ol><p><strong>\u521D\u59CB\u6807\u8BB0</strong> \u4EC5\u4EC5\u662F\u6807\u8BB0 <code>GC Roots</code> \u5185 <strong>\u76F4\u63A5\u5173\u8054</strong> \u7684\u5BF9\u8C61\u3002\u8FD9\u4E2A\u9636\u6BB5 <strong>\u901F\u5EA6\u5F88\u5FEB</strong>\uFF0C\u9700\u8981 <code>Stop the World</code>\u3002</p><ol start="2"><li><strong>\u5E76\u53D1\u6807\u8BB0\uFF08CMS concurrent mark\uFF09</strong></li></ol><p><strong>\u5E76\u53D1\u6807\u8BB0</strong> \u8FDB\u884C\u7684\u662F <code>GC Tracing</code>\uFF0C\u4ECE <code>GC Roots</code> \u5F00\u59CB\u5BF9\u5806\u8FDB\u884C <strong>\u53EF\u8FBE\u6027\u5206\u6790</strong>\uFF0C\u627E\u51FA <strong>\u5B58\u6D3B\u5BF9\u8C61</strong>\u3002</p><ol start="3"><li><strong>\u91CD\u65B0\u6807\u8BB0\uFF08CMS remark\uFF09</strong></li></ol><p><strong>\u91CD\u65B0\u6807\u8BB0</strong> \u9636\u6BB5\u4E3A\u4E86 <strong>\u4FEE\u6B63</strong> \u5E76\u53D1\u671F\u95F4\u7531\u4E8E <strong>\u7528\u6237\u8FDB\u884C\u8FD0\u4F5C</strong> \u5BFC\u81F4\u7684 <strong>\u6807\u8BB0\u53D8\u52A8</strong> \u7684\u90A3\u4E00\u90E8\u5206\u5BF9\u8C61\u7684 <strong>\u6807\u8BB0\u8BB0\u5F55</strong>\u3002\u8FD9\u4E2A\u9636\u6BB5\u7684 <strong>\u505C\u987F\u65F6\u95F4</strong> \u4E00\u822C\u4F1A\u6BD4 <strong>\u521D\u59CB\u6807\u8BB0\u9636\u6BB5</strong> \u7A0D\u957F\u4E00\u4E9B\uFF0C\u4F46\u8FDC\u6BD4 <strong>\u5E76\u53D1\u6807\u8BB0</strong> \u7684\u65F6\u95F4\u77ED\uFF0C\u4E5F\u9700\u8981 <code>Stop The World</code>\u3002</p><ol start="4"><li><strong>\u5E76\u53D1\u6E05\u9664\uFF08CMS concurrent sweep\uFF09</strong></li></ol><p><strong>\u5E76\u53D1\u6E05\u9664</strong> \u9636\u6BB5\u4F1A\u6E05\u9664\u5783\u573E\u5BF9\u8C61\u3002</p><blockquote><p><strong>\u521D\u59CB\u6807\u8BB0</strong>\uFF08<code>CMS initial mark</code>\uFF09\u548C <strong>\u91CD\u65B0\u6807\u8BB0</strong>\uFF08<code>CMS remark</code>\uFF09\u4F1A\u5BFC\u81F4 <strong>\u7528\u6237\u7EBF\u7A0B</strong> \u5361\u987F\uFF0C<code>Stop the World</code> \u73B0\u8C61\u53D1\u751F\u3002</p></blockquote><p>\u5728\u6574\u4E2A\u8FC7\u7A0B\u4E2D\uFF0C<code>CMS</code> \u56DE\u6536\u5668\u7684 <strong>\u5185\u5B58\u56DE\u6536</strong> \u57FA\u672C\u4E0A\u548C <strong>\u7528\u6237\u7EBF\u7A0B</strong> \u5E76\u53D1\u6267\u884C,\u5982\u4E0B\u56FE\u6240\u793A\uFF1A <img src="'+L+'" alt=""> \u7531\u4E8E <code>CMS</code> \u56DE\u6536\u5668 <strong>\u5E76\u53D1\u6536\u96C6</strong>\u3001<strong>\u505C\u987F\u4F4E</strong>\uFF0C\u56E0\u6B64\u6709\u4E9B\u5730\u65B9\u6210\u4E3A** \u5E76\u53D1\u4F4E\u505C\u987F\u56DE\u6536\u5668**\uFF08<code>Concurrent Low Pause Sweep Collector</code>\uFF09\u3002</p><p><code>CMS</code> \u56DE\u6536\u5668\u7684\u7F3A\u70B9\uFF1A</p><ol><li><strong>CMS\u56DE\u6536\u5668\u5BF9CPU\u8D44\u6E90\u975E\u5E38\u4F9D\u8D56</strong></li></ol><p><code>CMS</code> \u56DE\u6536\u5668\u8FC7\u5206\u4F9D\u8D56\u4E8E <strong>\u591A\u7EBF\u7A0B\u73AF\u5883</strong>\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5F00\u542F\u7684 <strong>\u7EBF\u7A0B\u6570</strong> \u4E3A<code>\uFF08CPU \u7684\u6570\u91CF + 3\uFF09/ 4</code>\uFF0C\u5F53 <code>CPU</code> \u6570\u91CF\u5C11\u4E8E <code>4</code> \u4E2A\u65F6\uFF0C<code>CMS</code> \u5BF9 <strong>\u7528\u6237\u67E5\u8BE2</strong> \u7684\u5F71\u54CD\u5C06\u4F1A\u5F88\u5927\uFF0C\u56E0\u4E3A\u4ED6\u4EEC\u8981\u5206\u51FA\u4E00\u534A\u7684\u8FD0\u7B97\u80FD\u529B\u53BB <strong>\u6267\u884C\u56DE\u6536\u5668\u7EBF\u7A0B</strong>\uFF1B</p><ol start="2"><li><strong>CMS\u56DE\u6536\u5668\u65E0\u6CD5\u6E05\u9664\u6D6E\u52A8\u5783\u573E</strong></li></ol><p>\u7531\u4E8E <code>CMS</code> \u56DE\u6536\u5668 <strong>\u6E05\u9664\u5DF2\u6807\u8BB0\u7684\u5783\u573E</strong> \uFF08\u5904\u4E8E\u6700\u540E\u4E00\u4E2A\u9636\u6BB5\uFF09\u65F6\uFF0C<strong>\u7528\u6237\u7EBF\u7A0B</strong> \u8FD8\u5728\u8FD0\u884C\uFF0C\u56E0\u6B64\u4F1A\u6709\u65B0\u7684\u5783\u573E\u4EA7\u751F\u3002\u4F46\u662F\u8FD9\u90E8\u5206\u5783\u573E <strong>\u672A\u88AB\u6807\u8BB0</strong>\uFF0C\u5728\u4E0B\u4E00\u6B21 <code>GC</code> \u624D\u80FD\u6E05\u9664\uFF0C\u56E0\u6B64\u88AB\u6210\u4E3A <strong>\u6D6E\u52A8\u5783\u573E</strong>\u3002</p><p>\u7531\u4E8E <strong>\u5185\u5B58\u56DE\u6536</strong> \u548C <strong>\u7528\u6237\u7EBF\u7A0B</strong> \u662F\u540C\u65F6\u8FDB\u884C\u7684\uFF0C\u5185\u5B58\u5728\u88AB <strong>\u56DE\u6536</strong> \u7684\u540C\u65F6\uFF0C\u4E5F\u5728\u88AB <strong>\u5206\u914D</strong>\u3002\u5F53 <strong>\u8001\u751F\u4EE3</strong> \u4E2D\u7684\u5185\u5B58\u4F7F\u7528\u8D85\u8FC7\u4E00\u5B9A\u7684\u6BD4\u4F8B\u65F6\uFF0C\u7CFB\u7EDF\u5C06\u4F1A\u8FDB\u884C <strong>\u5783\u573E\u56DE\u6536</strong>\uFF1B\u5F53 <strong>\u5269\u4F59\u5185\u5B58</strong> \u4E0D\u80FD\u6EE1\u8DB3\u7A0B\u5E8F\u8FD0\u884C\u8981\u6C42\u65F6\uFF0C\u7CFB\u7EDF\u5C06\u4F1A\u51FA\u73B0 <code>Concurrent Mode Failure</code>\uFF0C\u4E34\u65F6\u91C7\u7528 <code>Serial Old</code> \u7B97\u6CD5\u8FDB\u884C <strong>\u6E05\u9664</strong>\uFF0C\u6B64\u65F6\u7684 <strong>\u6027\u80FD</strong> \u5C06\u4F1A\u964D\u4F4E\u3002</p><ol start="3"><li><strong>\u5783\u573E\u6536\u96C6\u7ED3\u675F\u540E\u6B8B\u4F59\u5927\u91CF\u7A7A\u95F4\u788E\u7247</strong></li></ol><p><code>CMS</code> \u56DE\u6536\u5668\u91C7\u7528\u7684 <strong>\u6807\u8BB0\u6E05\u9664\u7B97\u6CD5</strong>\uFF0C\u672C\u8EAB\u5B58\u5728\u5783\u573E\u6536\u96C6\u7ED3\u675F\u540E\u6B8B\u4F59 <strong>\u5927\u91CF\u7A7A\u95F4\u788E\u7247</strong> \u7684\u7F3A\u70B9\u3002CMS \u914D\u5408\u9002\u5F53\u7684 <strong>\u5185\u5B58\u6574\u7406\u7B56\u7565</strong>\uFF0C\u5728\u4E00\u5B9A\u7A0B\u5EA6\u4E0A\u53EF\u4EE5\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\u3002</p><p><strong>5.2. G1\u56DE\u6536\u5668\uFF08\u5783\u573E\u533A\u57DFRegion\u4F18\u5148\uFF09</strong><code>G1</code> \u662F <code>JDK 1.7</code> \u4E2D\u6B63\u5F0F\u6295\u5165\u4F7F\u7528\u7684\u7528\u4E8E\u53D6\u4EE3 <code>CMS</code> \u7684 <strong>\u538B\u7F29\u56DE\u6536\u5668</strong>\u3002\u5B83\u867D\u7136\u6CA1\u6709\u5728\u7269\u7406\u4E0A\u9694\u65AD <strong>\u65B0\u751F\u4EE3</strong> \u4E0E <strong>\u8001\u751F\u4EE3</strong>\uFF0C\u4F46\u662F\u4ECD\u7136\u5C5E\u4E8E <strong>\u5206\u4EE3\u5783\u573E\u56DE\u6536\u5668</strong>\u3002<code>G1</code> \u4ECD\u7136\u4F1A\u533A\u5206 <strong>\u5E74\u8F7B\u4EE3</strong> \u4E0E <strong>\u8001\u5E74\u4EE3</strong>\uFF0C\u5E74\u8F7B\u4EE3\u4F9D\u7136\u5206\u6709 <code>Eden</code> \u533A\u4E0E <code>Survivor</code> \u533A\u3002</p><p><code>G1</code> \u9996\u5148\u5C06 <strong>\u5806</strong> \u5206\u4E3A <strong>\u5927\u5C0F\u76F8\u7B49</strong> \u7684 <code>Region</code>\uFF0C\u907F\u514D <strong>\u5168\u533A\u57DF</strong> \u7684\u5783\u573E\u56DE\u6536\u3002\u7136\u540E\u8FFD\u8E2A\u6BCF\u4E2A <code>Region</code> \u5783\u573E <strong>\u5806\u79EF\u7684\u4EF7\u503C\u5927\u5C0F</strong>\uFF0C\u5728\u540E\u53F0\u7EF4\u62A4\u4E00\u4E2A <strong>\u4F18\u5148\u5217\u8868</strong>\uFF0C\u6839\u636E\u5141\u8BB8\u7684\u56DE\u6536\u65F6\u95F4\u4F18\u5148\u56DE\u6536\u4EF7\u503C\u6700\u5927\u7684 <code>Region</code>\u3002\u540C\u65F6 <code>G1</code>\u91C7\u7528 <code>Remembered Set</code> \u6765\u5B58\u653E <code>Region</code> \u4E4B\u95F4\u7684 <strong>\u5BF9\u8C61\u5F15\u7528</strong> \uFF0C\u5176\u4ED6\u56DE\u6536\u5668\u4E2D\u7684 <strong>\u65B0\u751F\u4EE3</strong> \u4E0E <strong>\u8001\u5E74\u4EE3</strong> \u4E4B\u95F4\u7684\u5BF9\u8C61\u5F15\u7528\uFF0C\u4ECE\u800C\u907F\u514D <strong>\u5168\u5806\u626B\u63CF</strong>\u3002G1 \u7684\u5206\u533A\u793A\u4F8B\u5982\u4E0B\u56FE\u6240\u793A\uFF1A <img src="'+P+`" alt=""></p><p>\u8FD9\u79CD\u4F7F\u7528 <code>Region</code> \u5212\u5206 <strong>\u5185\u5B58\u7A7A\u95F4</strong> \u4EE5\u53CA\u6709 <strong>\u4F18\u5148\u7EA7</strong> \u7684\u533A\u57DF\u56DE\u6536\u65B9\u5F0F\uFF0C\u4FDD\u8BC1 <code>G1</code> \u56DE\u6536\u5668\u5728\u6709\u9650\u7684\u65F6\u95F4\u5185\u53EF\u4EE5\u83B7\u5F97\u5C3D\u53EF\u80FD <strong>\u9AD8\u7684\u56DE\u6536\u6548\u7387</strong>\u3002</p><p><code>G1</code> \u548C <code>CMS</code> \u8FD0\u4F5C\u8FC7\u7A0B\u6709\u5F88\u591A\u76F8\u4F3C\u4E4B\u5904\uFF0C\u6574\u4E2A\u8FC7\u7A0B\u4E5F\u5206\u4E3A <code>4</code> \u4E2A\u6B65\u9AA4\uFF1A</p><ol><li><strong>\u521D\u59CB\u6807\u8BB0\uFF08CMS initial mark\uFF09</strong></li></ol><p><strong>\u521D\u59CB\u6807\u8BB0</strong> \u4EC5\u4EC5\u662F\u6807\u8BB0 <code>GC Roots</code> \u5185 <strong>\u76F4\u63A5\u5173\u8054</strong> \u7684\u5BF9\u8C61\u3002\u8FD9\u4E2A\u9636\u6BB5 <strong>\u901F\u5EA6\u5F88\u5FEB</strong>\uFF0C\u9700\u8981 <code>Stop the World</code>\u3002</p><ol start="2"><li><strong>\u5E76\u53D1\u6807\u8BB0\uFF08CMS concurrent mark\uFF09</strong></li></ol><p><strong>\u5E76\u53D1\u6807\u8BB0</strong> \u8FDB\u884C\u7684\u662F <code>GC Tracing</code>\uFF0C\u4ECE <code>GC Roots</code> \u5F00\u59CB\u5BF9\u5806\u8FDB\u884C <strong>\u53EF\u8FBE\u6027\u5206\u6790</strong>\uFF0C\u627E\u51FA <strong>\u5B58\u6D3B\u5BF9\u8C61</strong>\u3002</p><ol start="3"><li><strong>\u91CD\u65B0\u6807\u8BB0\uFF08CMS remark\uFF09</strong></li></ol><p><strong>\u91CD\u65B0\u6807\u8BB0</strong> \u9636\u6BB5\u4E3A\u4E86 <strong>\u4FEE\u6B63</strong> \u5E76\u53D1\u671F\u95F4\u7531\u4E8E <strong>\u7528\u6237\u8FDB\u884C\u8FD0\u4F5C</strong> \u5BFC\u81F4\u7684 <strong>\u6807\u8BB0\u53D8\u52A8</strong> \u7684\u90A3\u4E00\u90E8\u5206\u5BF9\u8C61\u7684 <strong>\u6807\u8BB0\u8BB0\u5F55</strong>\u3002\u8FD9\u4E2A\u9636\u6BB5\u7684 <strong>\u505C\u987F\u65F6\u95F4</strong> \u4E00\u822C\u4F1A\u6BD4 <strong>\u521D\u59CB\u6807\u8BB0\u9636\u6BB5</strong> \u7A0D\u957F\u4E00\u4E9B\uFF0C\u4F46\u8FDC\u6BD4 <strong>\u5E76\u53D1\u6807\u8BB0</strong> \u7684\u65F6\u95F4\u77ED\uFF0C\u4E5F\u9700\u8981 <code>Stop The World</code>\u3002</p><ol start="4"><li><strong>\u7B5B\u9009\u56DE\u6536</strong></li></ol><p>\u9996\u5148\u5BF9\u5404\u4E2A <code>Region</code> \u7684 <strong>\u56DE\u6536\u4EF7\u503C</strong> \u548C <strong>\u6210\u672C</strong> \u8FDB\u884C\u6392\u5E8F\uFF0C\u6839\u636E\u7528\u6237\u6240\u671F\u671B\u7684 <code>GC</code> <strong>\u505C\u987F\u65F6\u95F4</strong> \u6765\u5236\u5B9A\u56DE\u6536\u8BA1\u5212\u3002\u8FD9\u4E2A\u9636\u6BB5\u53EF\u4EE5\u4E0E\u7528\u6237\u7A0B\u5E8F\u4E00\u8D77 <strong>\u5E76\u53D1\u6267\u884C</strong>\uFF0C\u4F46\u662F\u56E0\u4E3A\u53EA\u56DE\u6536\u4E00\u90E8\u5206 <code>Region</code>\uFF0C\u65F6\u95F4\u662F\u7528\u6237\u53EF\u63A7\u5236\u7684\uFF0C\u800C\u4E14\u505C\u987F <strong>\u7528\u6237\u7EBF\u7A0B</strong> \u5C06\u5927\u5E45\u63D0\u9AD8\u56DE\u6536\u6548\u7387\u3002</p><blockquote><p>\u4E0E\u5176\u5B83 <code>GC</code> \u56DE\u6536\u76F8\u6BD4\uFF0C<code>G1</code> \u5177\u5907\u5982\u4E0B <code>4</code> \u4E2A\u7279\u70B9\uFF1A</p></blockquote><ul><li><strong>\u5E76\u884C\u4E0E\u5E76\u53D1</strong></li></ul><p>\u4F7F\u7528\u591A\u4E2A <code>CPU</code> \u6765\u7F29\u77ED <code>Stop-the-World</code> \u7684 <strong>\u505C\u987F\u65F6\u95F4</strong>\uFF0C\u90E8\u5206\u5176\u4ED6\u56DE\u6536\u5668\u9700\u8981\u505C\u987F <code>Java</code> \u7EBF\u7A0B\u6267\u884C\u7684 <code>GC</code> \u52A8\u4F5C\uFF0C<code>G1</code> \u56DE\u6536\u5668\u4ECD\u7136\u53EF\u4EE5\u901A\u8FC7 \u5E76<strong>\u53D1\u7684\u65B9\u5F0F</strong> \u8BA9 <code>Java</code> \u7A0B\u5E8F\u7EE7\u7EED\u6267\u884C\u3002</p><ul><li><strong>\u5206\u4EE3\u56DE\u6536</strong></li></ul><p>\u4E0E\u5176\u4ED6\u56DE\u6536\u5668\u4E00\u6837\uFF0C<strong>\u5206\u4EE3\u6982\u5FF5</strong> \u5728 <code>G1</code> \u4E2D\u4F9D\u7136\u5F97\u4EE5\u4FDD\u7559\u3002\u867D\u7136 <code>G1</code> \u53EF\u4EE5\u4E0D\u9700\u8981 <strong>\u5176\u4ED6\u56DE\u6536\u5668\u914D\u5408</strong> \u5C31\u80FD\u72EC\u7ACB\u7BA1\u7406 <strong>\u6574\u4E2AGC\u5806</strong>\uFF0C\u4F46\u5B83\u80FD\u591F\u91C7\u7528 <strong>\u4E0D\u540C\u7684\u7B56\u7565</strong> \u53BB\u5904\u7406 <strong>\u65B0\u521B\u5EFA\u7684\u5BF9\u8C61</strong> \u548C <strong>\u5DF2\u7ECF\u5B58\u6D3B</strong> \u4E00\u6BB5\u65F6\u95F4\u3001<strong>\u71AC\u8FC7\u591A\u6B21</strong> <code>GC</code> \u7684\u65E7\u5BF9\u8C61\uFF0C\u4EE5\u83B7\u53D6\u66F4\u597D\u7684\u56DE\u6536\u6548\u679C\u3002<strong>\u65B0\u751F\u4EE3</strong> \u548C <strong>\u8001\u5E74\u4EE3</strong> \u4E0D\u518D\u662F <strong>\u7269\u7406\u9694\u79BB</strong>\uFF0C\u662F\u591A\u4E2A <strong>\u5927\u5C0F\u76F8\u7B49</strong> \u7684\u72EC\u7ACB <code>Region</code>\u3002</p><ul><li><strong>\u7A7A\u95F4\u6574\u5408</strong></li></ul><p>\u4E0E <code>CMS</code> \u7684 <strong>\u6807\u8BB0\u2014\u6E05\u7406</strong> \u7B97\u6CD5\u4E0D\u540C\uFF0C<code>G1</code> \u4ECE <strong>\u6574\u4F53</strong> \u6765\u770B\u662F\u57FA\u4E8E <strong>\u6807\u8BB0\u2014\u6574\u7406</strong> \u7B97\u6CD5\u5B9E\u73B0\u7684\u56DE\u6536\u5668\u3002\u4ECE <strong>\u5C40\u90E8</strong>\uFF08\u4E24\u4E2A <code>Region</code> \u4E4B\u95F4\uFF09\u4E0A\u6765\u770B\u662F\u57FA\u4E8E <strong>\u590D\u5236\u7B97\u6CD5</strong> \u5B9E\u73B0\u7684\u3002 \u4F46\u65E0\u8BBA\u5982\u4F55\uFF0C\u8FD9 <strong>\u4E24\u79CD\u7B97\u6CD5</strong> \u90FD\u610F\u5473\u7740 <code>G1</code> \u8FD0\u4F5C\u671F\u95F4 <strong>\u4E0D\u4F1A\u4EA7\u751F\u5185\u5B58\u7A7A\u95F4\u788E\u7247</strong>\uFF0C\u56DE\u6536\u540E\u80FD\u63D0\u4F9B\u89C4\u6574\u7684\u53EF\u7528\u5185\u5B58\u3002\u8FD9\u79CD\u7279\u6027\u6709\u5229\u4E8E\u7A0B\u5E8F\u957F\u65F6\u95F4\u8FD0\u884C\uFF0C<strong>\u5206\u914D\u5927\u5BF9\u8C61</strong> \u65F6\u4E0D\u4F1A\u56E0\u4E3A\u65E0\u6CD5\u627E\u5230 <strong>\u8FDE\u7EED\u5185\u5B58\u7A7A\u95F4</strong> \u800C\u63D0\u524D\u89E6\u53D1 <strong>\u4E0B\u4E00\u6B21</strong> <code>GC</code>\u3002</p><ul><li><strong>\u53EF\u9884\u6D4B\u7684\u505C\u987F</strong></li></ul><p>\u8FD9\u662F <code>G1</code> \u76F8\u5BF9\u4E8E <code>CMS</code> \u7684\u53E6\u4E00\u5927\u4F18\u52BF\uFF0C\u964D\u4F4E\u505C\u987F\u65F6\u95F4 \u662F <code>G1</code> \u548C <code>CMS</code> \u5171\u540C\u7684\u5173\u6CE8\u70B9\u3002G1 \u9664\u4E86\u8FFD\u6C42 <strong>\u4F4E\u505C\u987F</strong> \u5916\uFF0C\u8FD8\u80FD\u5EFA\u7ACB <strong>\u53EF\u9884\u6D4B</strong> \u7684 <strong>\u505C\u987F\u65F6\u95F4\u6A21\u578B</strong>\uFF0C\u80FD\u8BA9\u4F7F\u7528\u8005\u660E\u786E\u6307\u5B9A\u5728\u4E00\u4E2A <strong>\u957F\u5EA6</strong> \u4E3A <code>M</code> \u6BEB\u79D2\u7684 <strong>\u65F6\u95F4\u7247\u6BB5</strong> \u5185\uFF0C\u6D88\u8017\u5728 <strong>\u5783\u573E\u56DE\u6536</strong> \u4E0A\u7684\u65F6\u95F4\u4E0D\u5F97\u8D85\u8FC7 <code>N</code> \u6BEB\u79D2\u3002\uFF08\u540E\u53F0\u7EF4\u62A4\u7684 <strong>\u4F18\u5148\u5217\u8868</strong>\uFF0C\u4F18\u5148\u56DE\u6536 <strong>\u4EF7\u503C\u5927</strong> \u7684 <code>Region</code>\uFF09\u3002</p><h2 id="\u5E38\u7528\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a> \u5E38\u7528\u547D\u4EE4</h2><h3 id="jps" tabindex="-1"><a class="header-anchor" href="#jps" aria-hidden="true">#</a> jps</h3><hr><p>JVM Process Status Tool,\u663E\u793A\u6307\u5B9A\u7CFB\u7EDF\u5185\u6240\u6709\u7684HotSpot\u865A\u62DF\u673A\u8FDB\u7A0B\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jps [option] [hostid]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>Option</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>-l</td><td>\u8F93\u51FA\u4E3B\u7C7B\u5168\u540D\u6216jar\u8DEF\u5F84</td></tr><tr><td>-q</td><td>\u53EA\u8F93\u51FALVMID</td></tr><tr><td>-m</td><td>\u8F93\u51FAJVM\u542F\u52A8\u65F6\u4F20\u9012\u7ED9main()\u7684\u53C2\u6570</td></tr><tr><td>-v</td><td>\u8F93\u51FAJVM\u542F\u52A8\u65F6\u663E\u793A\u6307\u5B9A\u7684JVM\u53C2\u6570</td></tr></tbody></table><h3 id="jstat" tabindex="-1"><a class="header-anchor" href="#jstat" aria-hidden="true">#</a> jstat</h3><hr><p>jstat(JVM statistics Monitoring)\u662F\u7528\u4E8E\u76D1\u89C6\u865A\u62DF\u673A\u8FD0\u884C\u65F6\u72B6\u6001\u4FE1\u606F\u7684\u547D\u4EE4\uFF0C\u5B83\u53EF\u4EE5\u663E\u793A\u51FA\u865A\u62DF\u673A\u8FDB\u7A0B\u4E2D\u7684\u7C7B\u88C5\u8F7D\u3001\u5185\u5B58\u3001\u5783\u573E\u6536\u96C6\u3001JIT\u7F16\u8BD1\u7B49\u8FD0\u884C\u6570\u636E\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jstat [option] LVMID [interval] [count]

[option] : \u64CD\u4F5C\u53C2\u6570
LVMID : \u672C\u5730\u865A\u62DF\u673A\u8FDB\u7A0BID
[interval] : \u8FDE\u7EED\u8F93\u51FA\u7684\u65F6\u95F4\u95F4\u9694
[count] : \u8FDE\u7EED\u8F93\u51FA\u7684\u6B21\u6570
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>Option</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>class</td><td>class loader\u7684\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics on the behavior of the class loader.</td></tr><tr><td>compiler</td><td>HotSpt JIT\u7F16\u8BD1\u5668\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the behavior of the HotSpot Just-in-Time compiler.</td></tr><tr><td>gc</td><td>\u5783\u573E\u56DE\u6536\u5806\u7684\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the behavior of the garbage collected heap.</td></tr><tr><td>gccapacity</td><td>\u5404\u4E2A\u5783\u573E\u56DE\u6536\u4EE3\u5BB9\u91CF(young,old,perm)\u548C\u4ED6\u4EEC\u76F8\u5E94\u7684\u7A7A\u95F4\u7EDF\u8BA1\u3002Statistics of the capacities of the generations and their corresponding spaces.</td></tr><tr><td>gcutil</td><td>\u5783\u573E\u56DE\u6536\u7EDF\u8BA1\u6982\u8FF0\u3002Summary of garbage collection statistics.</td></tr><tr><td>gccause</td><td>\u5783\u573E\u6536\u96C6\u7EDF\u8BA1\u6982\u8FF0\uFF08\u540C-gcutil\uFF09\uFF0C\u9644\u52A0\u6700\u8FD1\u4E24\u6B21\u5783\u573E\u56DE\u6536\u4E8B\u4EF6\u7684\u539F\u56E0\u3002Summary of garbage collection statistics (same as -gcutil), with the cause of the last and</td></tr><tr><td>gcnew</td><td>\u65B0\u751F\u4EE3\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the behavior of the new generation.</td></tr><tr><td>gcnewcapacity</td><td>\u65B0\u751F\u4EE3\u4E0E\u5176\u76F8\u5E94\u7684\u5185\u5B58\u7A7A\u95F4\u7684\u7EDF\u8BA1\u3002Statistics of the sizes of the new generations and its corresponding spaces.</td></tr><tr><td>gcold</td><td>\u5E74\u8001\u4EE3\u548C\u6C38\u751F\u4EE3\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the behavior of the old and permanent generations.</td></tr><tr><td>gcoldcapacity</td><td>\u5E74\u8001\u4EE3\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the sizes of the old generation.</td></tr><tr><td>gcpermcapacity</td><td>\u6C38\u751F\u4EE3\u884C\u4E3A\u7EDF\u8BA1\u3002Statistics of the sizes of the permanent generation.</td></tr><tr><td>printcompilation</td><td>HotSpot\u7F16\u8BD1\u65B9\u6CD5\u7EDF\u8BA1\u3002HotSpot compilation method statistics.</td></tr><tr><td><strong>\u4F8B\u5982\u67E5\u770B\u5783\u573E\u56DE\u6536\u5806\u7684\u884C\u4E3A\u7EDF\u8BA1</strong></td><td></td></tr></tbody></table><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[root@VM_247_254_centos ~]# jstat -gc 25446
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT
6400.0 6400.0  0.0   1601.4 51712.0  50837.0   128808.0   88450.0   67584.0 66167.7 7936.0 7630.5    401    5.939  10      1.247    7.186
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53C2\u6570\u610F\u4E49\uFF1A C\uFF1ACapacity\u8868\u793A\u7684\u662F\u5BB9\u91CF U\uFF1AUsed\u8868\u793A\u7684\u662F\u5DF2\u4F7F\u7528</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>S0C : survivor0\u533A\u7684\u603B\u5BB9\u91CF
S1C : survivor1\u533A\u7684\u603B\u5BB9\u91CF
S0U : survivor0\u533A\u5DF2\u4F7F\u7528\u7684\u5BB9\u91CF
S1C : survivor1\u533A\u5DF2\u4F7F\u7528\u7684\u5BB9\u91CF
EC : Eden\u533A\u7684\u603B\u5BB9\u91CF
EU : Eden\u533A\u5DF2\u4F7F\u7528\u7684\u5BB9\u91CF
OC : Old\u533A\u7684\u603B\u5BB9\u91CF
OU : Old\u533A\u5DF2\u4F7F\u7528\u7684\u5BB9\u91CF
PC \u5F53\u524Dperm\u7684\u5BB9\u91CF (KB)
PU perm\u7684\u4F7F\u7528 (KB)
YGC : \u65B0\u751F\u4EE3\u5783\u573E\u56DE\u6536\u6B21\u6570
YGCT : \u65B0\u751F\u4EE3\u5783\u573E\u56DE\u6536\u65F6\u95F4
FGC : \u8001\u5E74\u4EE3\u5783\u573E\u56DE\u6536\u6B21\u6570
FGCT : \u8001\u5E74\u4EE3\u5783\u573E\u56DE\u6536\u65F6\u95F4
GCT : \u5783\u573E\u56DE\u6536\u603B\u6D88\u8017\u65F6\u95F4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jmap" tabindex="-1"><a class="header-anchor" href="#jmap" aria-hidden="true">#</a> jmap</h3><p>jmap(JVM Memory Map)\u547D\u4EE4\u7528\u4E8E\u751F\u6210heap dump\u6587\u4EF6\uFF0C\u5982\u679C\u4E0D\u4F7F\u7528\u8FD9\u4E2A\u547D\u4EE4\uFF0C\u53EF\u4EE5\u4F7F\u7528-XX:+HeapDumpOnOutOfMemoryError\u53C2\u6570\u6765\u8BA9\u865A\u62DF\u673A\u51FA\u73B0OOM\u7684\u65F6\u5019\uFF0C\u81EA\u52A8\u751F\u6210dump\u6587\u4EF6\u3002 jmap\u4E0D\u4EC5\u80FD\u751F\u6210dump\u6587\u4EF6\uFF0C\u8FD8\u53EF\u4EE5\u67E5\u8BE2finalize\u6267\u884C\u961F\u5217\u3001Java\u5806\u548C\u6C38\u4E45\u4EE3\u7684\u8BE6\u7EC6\u4FE1\u606F\uFF0C\u5982\u5F53\u524D\u4F7F\u7528\u7387\u3001\u5F53\u524D\u4F7F\u7528\u7684\u662F\u54EA\u79CD\u6536\u96C6\u5668\u7B49\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jmap [option] LVMID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>Option</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>dump</td><td>\u751F\u6210\u5806\u8F6C\u50A8\u5FEB\u7167</td></tr><tr><td>finalizerinfo</td><td>\u663E\u793A\u5728F-Queue\u961F\u5217\u7B49\u5F85Finalizer\u7EBF\u7A0B\u6267\u884Cfinalizer\u65B9\u6CD5\u7684\u5BF9\u8C61</td></tr><tr><td>heap</td><td>\u663E\u793AJava\u5806\u8BE6\u7EC6\u4FE1\u606F</td></tr><tr><td>histo</td><td>\u663E\u793A\u5806\u4E2D\u5BF9\u8C61\u7684\u7EDF\u8BA1\u4FE1\u606F</td></tr><tr><td>permstat</td><td>to print permanent generation statistics</td></tr><tr><td>F</td><td>\u5F53-dump\u6CA1\u6709\u54CD\u5E94\u65F6\uFF0C\u5F3A\u5236\u751F\u6210dump\u5FEB\u7167</td></tr><tr><td>\u4F8B\u5B50</td><td></td></tr></tbody></table><ul><li><strong>-dump</strong></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jmap -dump:format=b,file=dump.dprof 25446
Dumping heap to /home/gem/dump.dprof ...
Heap dump file created
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u8F93\u51FA.dprof\u6587\u4EF6\u540E\uFF0C\u4F7F\u7528MAT\u5206\u6790\u5DE5\u5177\u8FDB\u884C\u5206\u6790</strong></p><ul><li><strong>-heap</strong>\u6253\u5370heap\u7684\u6982\u8981\u4FE1\u606F\uFF0CGC\u4F7F\u7528\u7684\u7B97\u6CD5\uFF0Cheap\u7684\u914D\u7F6E\u53CAwise heap\u7684\u4F7F\u7528\u60C5\u51B5,\u53EF\u4EE5\u7528\u6B64\u6765\u5224\u65AD\u5185\u5B58\u76EE\u524D\u7684\u4F7F\u7528\u60C5\u51B5\u4EE5\u53CA\u5783\u573E\u56DE\u6536\u60C5\u51B5</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jmap -heap 25446
Attaching to process ID 25446, please wait...
Debugger attached successfully.
Server compiler detected.
JVM version is 25.121-b13

using thread-local object allocation.
Mark Sweep Compact GC  //GC \u65B9\u5F0F ,\u8BE5\u6B21\u662F\u6807\u8BB0-\u6E05\u7406\u7B97\u6CD5\uFF0C\u4E0A\u4E00\u7BC7\u6709\u8BB0\u5F55\u54E6

//\u5806\u5185\u5B58\u521D\u59CB\u5316\u914D\u7F6E
Heap Configuration:  
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:MinHeapFreeRatio\u8BBE\u7F6EJVM\u5806\u6700\u5C0F\u7A7A\u95F2\u6BD4\u7387(default 40)
  MinHeapFreeRatio         = 40   
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570 -XX:MaxHeapFreeRatio\u8BBE\u7F6EJVM\u5806\u6700\u5927\u7A7A\u95F2\u6BD4\u7387(default 70)
  MaxHeapFreeRatio         = 70
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:MaxHeapSize=\u8BBE\u7F6EJVM\u5806\u7684\u6700\u5927\u5927\u5C0F
  MaxHeapSize              = 262144000 (250.0MB)
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:NewSize=\u8BBE\u7F6EJVM\u5806\u7684\u2018\u65B0\u751F\u4EE3\u2019\u7684\u9ED8\u8BA4\u5927\u5C0F
  NewSize                  = 5570560 (5.3125MB)
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:MaxNewSize=\u8BBE\u7F6EJVM\u5806\u7684\u2018\u65B0\u751F\u4EE3\u2019\uFF08YG\uFF09\u7684\u6700\u5927\u5927\u5C0F
  MaxNewSize               = 87359488 (83.3125MB)
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:OldSize=&lt;value&gt;:\u8BBE\u7F6EJVM\u5806\u7684\u2018\u8001\u751F\u4EE3\u2019\uFF08OG\uFF09\u7684\u5927\u5C0F
  OldSize                  = 11206656 (10.6875MB)
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:NewRatio=:\u2018\u65B0\u751F\u4EE3\u2019\u548C\u2018\u8001\u5E74\u4EE3\u2019\u7684\u5927\u5C0F\u6BD4\u7387
  NewRatio                 = 2
  //\u5BF9\u5E94jvm\u542F\u52A8\u53C2\u6570-XX:SurvivorRatio=\u8BBE\u7F6E\u5E74\u8F7B\u4EE3\u4E2DEden\u533A\u4E0ESurvivor\u533A\u7684\u5927\u5C0F\u6BD4\u503C 
  SurvivorRatio            = 8
  //\u5143\u7A7A\u95F4\u5927\u5C0F\uFF0C\u5BF9\u5E94-XX:MetaspaceSize\uFF0C\u521D\u59CB\u7A7A\u95F4\u5927\u5C0F
  //\u8FBE\u5230\u8BE5\u503C\u5C31\u4F1A\u89E6\u53D1\u5783\u573E\u6536\u96C6\u8FDB\u884C\u7C7B\u578B\u5378\u8F7D\uFF0C\u540C\u65F6GC\u4F1A\u5BF9\u8BE5\u503C\u8FDB\u884C\u8C03\u6574
  //JDK 8 \u4E2D\u6C38\u4E45\u4EE3\u5411\u5143\u7A7A\u95F4\u7684\u8F6C\u6362
  MetaspaceSize            = 21807104 (20.796875MB)
  //\u53EA\u6709\u5F53-XX:+UseCompressedClassPointers\u5F00\u542F\u4E86\u624D\u6709\u6548
  //\u901A\u8FC7java -XX:+PrintFlagsInitial | grep UseCompressedClassPointers
  //\u53D1\u73B0bool UseCompressedClassPointers= false\uFF0C\u662F\u6CA1\u6709\u542F\u7528\u7684
  CompressedClassSpaceSize = 1073741824 (1024.0MB)
  //\u5BF9\u5E94\u542F\u52A8\u53C2\u6570-XX:MaxMetaspaceSize\u5BF9\u5E94\u5143\u7A7A\u95F4\u6700\u5927\u5927\u5C0F
  MaxMetaspaceSize         = 17592186044415 MB
  //\u5F53\u4F7F\u7528G1\u6536\u96C6\u5668\u65F6\uFF0C\u8BBE\u7F6Ejava\u5806\u88AB\u5206\u5272\u7684\u5927\u5C0F\u3002\u8FD9\u4E2A\u5927\u5C0F\u8303\u56F4\u57281M\u523032M\u4E4B\u95F4\u3002
  //\u53EF\u80FD\u6211\u8FD9\u4E2AJVM\u6CA1\u6709\u542F\u7528G1\u6536\u96C6\u5668\uFF0C\u6240\u4EE5\u4E3A0
  G1HeapRegionSize         = 0 (0.0MB)

//\u5806\u5185\u5B58\u4F7F\u7528\u60C5\u51B5
Heap Usage:
//\u65B0\u7684\u590D\u5236\u7B97\u6CD5\uFF0C\u4E00\u4E2A\u4F0A\u7538\u533A+Survivor\u533A
New Generation (Eden + 1 Survivor Space):
  capacity = 59506688 (56.75MB)
  used     = 17941224 (17.110084533691406MB)
  free     = 41565464 (39.639915466308594MB)
  30.14992869372935% used
//Eden\u533A\u5185\u5B58\u5206\u5E03
Eden Space:
  capacity = 52953088 (50.5MB)
  used     = 17935840 (17.104949951171875MB)
  free     = 35017248 (33.395050048828125MB)
  33.871188022122524% used
//\u5176\u4E2D\u4E00\u4E2ASurvivor\u533A\u7684\u5185\u5B58\u5206\u5E03
From Space:
  capacity = 6553600 (6.25MB)
  used     = 5384 (0.00513458251953125MB)
  free     = 6548216 (6.244865417480469MB)
  0.0821533203125% used
//\u53E6\u4E00\u4E2ASurvivor\u533A\u7684\u5185\u5B58\u5206\u5E03
To Space:
  capacity = 6553600 (6.25MB)
  used     = 0 (0.0MB)
  free     = 6553600 (6.25MB)
  0.0% used
//\u2018\u5F53\u524D\u2019\u8001\u5E74\u4EE3\u5185\u5B58\u5206\u5E03
tenured generation:
  capacity = 131899392 (125.7890625MB)
  used     = 94610832 (90.22792053222656MB)
  free     = 37288560 (35.56114196777344MB)
  71.7295436812931% used

27405 interned Strings occupying 3101144 bytes.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jhat" tabindex="-1"><a class="header-anchor" href="#jhat" aria-hidden="true">#</a> <s>jhat</s></h3><p>jhat(JVM Heap Analysis Tool)\u547D\u4EE4\u662F\u4E0Ejmap\u642D\u914D\u4F7F\u7528\uFF0C\u7528\u6765\u5206\u6790jmap\u751F\u6210\u7684dump\uFF0Cjhat\u5185\u7F6E\u4E86\u4E00\u4E2A\u5FAE\u578B\u7684HTTP/HTML\u670D\u52A1\u5668\uFF0C\u751F\u6210dump\u7684\u5206\u6790\u7ED3\u679C\u540E\uFF0C\u53EF\u4EE5\u5728\u6D4F\u89C8\u5668\u4E2D\u67E5\u770B\u3002\u5728\u6B64\u8981\u6CE8\u610F\uFF0C\u4E00\u822C\u4E0D\u4F1A\u76F4\u63A5\u5728\u670D\u52A1\u5668\u4E0A\u8FDB\u884C\u5206\u6790\uFF0C\u56E0\u4E3Ajhat\u662F\u4E00\u4E2A\u8017\u65F6\u5E76\u4E14\u8017\u8D39\u786C\u4EF6\u8D44\u6E90\u7684\u8FC7\u7A0B\uFF0C\u4E00\u822C\u628A\u670D\u52A1\u5668\u751F\u6210\u7684dump\u6587\u4EF6\u590D\u5236\u5230\u672C\u5730\u6216\u5176\u4ED6\u673A\u5668\u4E0A\u8FDB\u884C\u5206\u6790\u3002 <strong>\u5E38\u7528\u5206\u6790\u65B9\u6CD5\u662F\u7528\u5404\u5E73\u53F0\u901A\u7528\u7684MAT\u8FDB\u884C\u5206\u6790</strong></p><h3 id="jstack" tabindex="-1"><a class="header-anchor" href="#jstack" aria-hidden="true">#</a> jstack</h3><p>jstack\u7528\u4E8E\u751F\u6210java\u865A\u62DF\u673A\u5F53\u524D\u65F6\u523B\u7684\u7EBF\u7A0B\u5FEB\u7167\u3002 \u7EBF\u7A0B\u5FEB\u7167\u662F\u5F53\u524Djava\u865A\u62DF\u673A\u5185\u6BCF\u4E00\u6761\u7EBF\u7A0B\u6B63\u5728\u6267\u884C\u7684\u65B9\u6CD5\u5806\u6808\u7684\u96C6\u5408\uFF0C\u751F\u6210\u7EBF\u7A0B\u5FEB\u7167\u7684\u4E3B\u8981\u76EE\u7684\u662F\u5B9A\u4F4D\u7EBF\u7A0B\u51FA\u73B0\u957F\u65F6\u95F4\u505C\u987F\u7684\u539F\u56E0\uFF0C\u5982\u7EBF\u7A0B\u95F4\u6B7B\u9501\u3001\u6B7B\u5FAA\u73AF\u3001\u8BF7\u6C42\u5916\u90E8\u8D44\u6E90\u5BFC\u81F4\u7684\u957F\u65F6\u95F4\u7B49\u5F85\u7B49\u3002 \u7EBF\u7A0B\u51FA\u73B0\u505C\u987F\u7684\u65F6\u5019\u901A\u8FC7jstack\u6765\u67E5\u770B\u5404\u4E2A\u7EBF\u7A0B\u7684\u8C03\u7528\u5806\u6808\uFF0C\u5C31\u53EF\u4EE5\u77E5\u9053\u6CA1\u6709\u54CD\u5E94\u7684\u7EBF\u7A0B\u5230\u5E95\u5728\u540E\u53F0\u505A\u4EC0\u4E48\u4E8B\u60C5\uFF0C\u6216\u8005\u7B49\u5F85\u4EC0\u4E48\u8D44\u6E90\u3002 \u5982\u679Cjava\u7A0B\u5E8F\u5D29\u6E83\u751F\u6210core\u6587\u4EF6\uFF0Cjstack\u5DE5\u5177\u53EF\u4EE5\u7528\u6765\u83B7\u5F97core\u6587\u4EF6\u7684java stack\u548Cnative stack\u7684\u4FE1\u606F\uFF0C\u4ECE\u800C\u53EF\u4EE5\u8F7B\u677E\u5730\u77E5\u9053java\u7A0B\u5E8F\u662F\u5982\u4F55\u5D29\u6E83\u548C\u5728\u7A0B\u5E8F\u4F55\u5904\u53D1\u751F\u95EE\u9898\u3002\u53E6\u5916\uFF0Cjstack\u5DE5\u5177\u8FD8\u53EF\u4EE5\u9644\u5C5E\u5230\u6B63\u5728\u8FD0\u884C\u7684java\u7A0B\u5E8F\u4E2D\uFF0C\u770B\u5230\u5F53\u65F6\u8FD0\u884C\u7684java\u7A0B\u5E8F\u7684java stack\u548Cnative stack\u7684\u4FE1\u606F, \u5982\u679C\u73B0\u5728\u8FD0\u884C\u7684java\u7A0B\u5E8F\u5448\u73B0hung\u7684\u72B6\u6001\uFF0Cjstack\u662F\u975E\u5E38\u6709\u7528\u7684\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jstack [option] LVMID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>Option</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>-F</td><td>\u5F53\u6B63\u5E38\u8F93\u51FA\u8BF7\u6C42\u4E0D\u88AB\u54CD\u5E94\u65F6\uFF0C\u5F3A\u5236\u8F93\u51FA\u7EBF\u7A0B\u5806\u6808</td></tr><tr><td>-l</td><td>\u9664\u5806\u6808\u5916\uFF0C\u663E\u793A\u5173\u4E8E\u9501\u7684\u9644\u52A0\u4FE1\u606F</td></tr><tr><td>-m</td><td>\u5982\u679C\u8C03\u7528\u5230\u672C\u5730\u65B9\u6CD5\u7684\u8BDD\uFF0C\u53EF\u4EE5\u663E\u793AC/C++\u7684\u5806\u6808</td></tr><tr><td>\u4F8B\u5B50</td><td></td></tr></tbody></table><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jstack -l 25446 | more
2018-01-25 21:18:22
Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.121-b13 mixed mode):

&quot;main-EventThread&quot; #174 daemon prio=5 os_prio=0 tid=0x00007feb692b7000 nid=0x6502 waiting on condition [0x00007feb32bb1000]
    //\u7B49\u5F85
   java.lang.Thread.State: WAITING (parking)
	at sun.misc.Unsafe.park(Native Method)
	- parking to wait for  &lt;0x00000000f0a00860&gt; (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)
	at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:442)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:501)

   Locked ownable synchronizers:
	- None

&quot;main-SendThread(115.159.192.69:2181)&quot; #173 daemon prio=5 os_prio=0 tid=0x00007feb694bd800 nid=0x6501 runnable [0x00007feb363ce000]
    //\u8FD0\u884C
   java.lang.Thread.State: RUNNABLE
	at sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)
	at sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:269)
	at sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:93)
	at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)
	- locked &lt;0x00000000f09ef268&gt; (a sun.nio.ch.Util$3)
	- locked &lt;0x00000000f09ef258&gt; (a java.util.Collections$UnmodifiableSet)
	- locked &lt;0x00000000f09ef140&gt; (a sun.nio.ch.EPollSelectorImpl)
	at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:349)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1141)

   Locked ownable synchronizers:
	- None
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jinfo" tabindex="-1"><a class="header-anchor" href="#jinfo" aria-hidden="true">#</a> jinfo</h3><p>jinfo(JVM Configuration info)\u8FD9\u4E2A\u547D\u4EE4\u4F5C\u7528\u662F\u5B9E\u65F6\u67E5\u770B\u548C\u8C03\u6574\u865A\u62DF\u673A\u8FD0\u884C\u53C2\u6570\u3002 \u4E4B\u524D\u7684jps -v\u53E3\u4EE4\u53EA\u80FD\u67E5\u770B\u5230\u663E\u793A\u6307\u5B9A\u7684\u53C2\u6570\uFF0C\u5982\u679C\u60F3\u8981\u67E5\u770B\u672A\u88AB\u663E\u793A\u6307\u5B9A\u7684\u53C2\u6570\u7684\u503C\u5C31\u8981\u4F7F\u7528jinfo\u53E3\u4EE4 <strong>\u4E00\u822C\u7528\u5B83\u6765\u770BJVM\u542F\u52A8\u65F6\u7684\u53C2\u6570</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>jinfo [option] [args] LVMID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><table><thead><tr><th>Option</th><th>\u89E3\u91CA</th></tr></thead><tbody><tr><td>-flag</td><td>\u8F93\u51FA\u6307\u5B9Aargs\u53C2\u6570\u7684\u503C</td></tr><tr><td>-flags</td><td>\u4E0D\u9700\u8981args\u53C2\u6570\uFF0C\u8F93\u51FA\u6240\u6709JVM\u53C2\u6570\u7684\u503C</td></tr><tr><td>-sysprops</td><td>\u8F93\u51FA\u7CFB\u7EDF\u5C5E\u6027\uFF0C\u7B49\u540C\u4E8ESystem.getProperties()</td></tr><tr><td>\u4F8B\u5B50</td><td></td></tr></tbody></table><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[root@VM_247_254_centos ~]# jinfo -flags 25446
Attaching to process ID 25446, please wait...
Debugger attached successfully.
Server compiler detected.
JVM version is 25.121-b13
Non-default VM flags: -XX:CICompilerCount=2 -XX:InitialHeapSize=16777216 -XX:MaxHeapSize=262144000 -XX:MaxNewSize=87359488 -XX:MinHeapDeltaBytes=196608 -XX:NewSize=5570560 -XX:OldSize=11206656 -XX:+UseCompressedClassPointers -XX:+UseCompressedOops
Command line:  -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -Dcatalina.base=/usr/local/tomcat -Dcatalina.home=/usr/local/tomcat -Djava.io.tmpdir=/usr/local/tomcat/temp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="jvm\u7EBF\u4E0A\u76D1\u63A7\u5DE5\u5177\u8BE6\u60C5" tabindex="-1"><a class="header-anchor" href="#jvm\u7EBF\u4E0A\u76D1\u63A7\u5DE5\u5177\u8BE6\u60C5" aria-hidden="true">#</a> JVM\u7EBF\u4E0A\u76D1\u63A7\u5DE5\u5177\u8BE6\u60C5</h3>`,267),X={href:"https://juejin.im/post/6844903655456374792",target:"_blank",rel:"noopener noreferrer"},R=l("JVM\u7EBF\u4E0A\u76D1\u63A7\u5DE5\u5177");function D(A,I){const s=t("ExternalLinkIcon");return e(),o("div",null,[G,n("p",null,[n("a",X,[R,p(s)])])])}var z=a(N,[["render",D],["__file","jvm.html.vue"]]);export{z as default};
