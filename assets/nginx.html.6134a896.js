import{_ as n,o as s,c as a,a as e}from"./app.7c042103.js";var i="/assets/1590930556225.ed908d31.jpg",p="/assets/1590930608819.d8ff5589.jpg",t="/assets/1590930635874.7924c414.jpg";const c={},l=e(`<h2 id="nginx\u4F5C\u4E3Acdn\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#nginx\u4F5C\u4E3Acdn\u4F7F\u7528" aria-hidden="true">#</a> Nginx\u4F5C\u4E3ACDN\u4F7F\u7528</h2><p>proxy_store</p><h2 id="nginx\u4F5C\u4E3A\u7F13\u5B58\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#nginx\u4F5C\u4E3A\u7F13\u5B58\u4F7F\u7528" aria-hidden="true">#</a> Nginx\u4F5C\u4E3A\u7F13\u5B58\u4F7F\u7528</h2><h3 id="proxy-cache-path" tabindex="-1"><a class="header-anchor" href="#proxy-cache-path" aria-hidden="true">#</a> proxy_cache_path</h3><blockquote><p><code>\u8BED\u6CD5\uFF1Aproxy_cache_path path [levels=levels] [use_temp_path=on|off] keys_zone=name:size [inactive=time] [max_size=size] [manager_files=number] [manager_sleep=time] [manager_threshold=time] [loader_files=number] [loader_sleep=time] [loader_threshold=time] [purger=on|off] [purger_files=number] [purger_sleep=time] [purger_threshold=time]\u3002</code></p></blockquote><p>\u53EA\u80FD\u7528\u5728http\u4E2D\u3002</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">proxy_cache_path</span> /root/cache levels=1:2 keys_zone=zzm_cache:10m max_size=1g inactive=60m use_temp_path=off</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u7F13\u5B58\u7BA1\u7406\u5668\u4F1A\u5B9A\u65F6\u68C0\u67E5\u7F13\u5B58\u7684\u72B6\u6001\u3002\u5982\u679C\u7F13\u5B58\u7684\u5185\u5BB9\u5927\u5C0F\u8FBE\u5230\u4E86\u6307\u4EE4proxy_cache_path\u7684\u53C2\u6570max-size\u6307\u5B9A\u7684\u503C,\u5219\u7F13\u5B58\u7BA1\u7406\u5668\u4F1A\u6839\u636ELRU\u7B97\u6CD5\u5220\u9664\u7F13\u5B58\u7684\u5185\u5BB9\u3002 \u5728\u68C0\u67E5\u7684\u95F4\u9694\u65F6\u95F4\u5185\uFF0C\u603B\u7684\u7F13\u5B58\u5185\u5BB9\u5927\u5C0F\u53EF\u4EE5\u4E34\u65F6\u8D85\u8FC7\u8BBE\u5B9A\u7684\u5927\u5C0F\u9608\u503C\u3002</li><li>\u7F13\u5B58\u52A0\u8F7D\u5668\u53EA\u5728Nginx\u542F\u52A8\u7684\u65F6\u5019\u6267\u884C\u4E00\u6B21\uFF0C\u5C06\u7F13\u5B58\u5185\u5BB9\u7684\u539F\u4FE1\u606F\u52A0\u8F7D\u5230\u6307\u5B9A\u7684\u5171\u4EAB\u5185\u5B58\u533A\u5185\u3002\u4E00\u6B21\u5C06\u6240\u6709\u7684\u7F13\u5B58\u5185\u5BB9\u52A0\u8F7D\u5230\u5185\u5B58\u4E2D\u4F1A\u8017\u8D39\u5927\u91CF\u7684\u8D44\u6E90\uFF0C\u5E76\u4E14\u4F1A\u5F71\u54CDNginx\u542F\u52A8\u540E\u51E0\u5206\u949F\u5185\u7684\u6027\u80FD\u3002\u4E3A\u4E86\u907F\u514D\u8FD9\u79CD\u95EE\u9898\u53EF\u4EE5\u901A\u8FC7\u5728\u6307\u4EE4proxy_cache_path\u540E\u6DFB\u52A0\u4E0B\u9762\u7684\u53C2\u6570\uFF1A <ul><li>loader_threshold \u2013 \u7F13\u5B58\u52A0\u8F7D\u5668\u52A0\u8F7D\u7F13\u5B58\u5185\u5BB9\u7684\u6700\u5927\u6267\u884C\u65F6\u95F4\uFF08\u5355\u4F4D\u662F\u6BEB\u79D2\uFF0C\u9ED8\u8BA4\u503C\u662F200\u6BEB\u79D2\uFF09</li><li>loader_files \u2013 \u5728\u7F13\u5B58\u52A0\u8F7D\u5668\u52A0\u8F7D\u7F13\u5B58\u5185\u5BB9\u7684\u6267\u884C\u65F6\u95F4\u95F4\u9694\u5185\uFF0C\u6700\u591A\u80FD\u52A0\u8F7D\u591A\u5C11\u4E2A\u7F13\u5B58\u6761\u76EE\uFF0C\u9ED8\u8BA4100\u3002</li><li>loader_sleeps \u2013 \u6BCF\u4E24\u6B21\u6267\u884C\u7684\u65F6\u95F4\u95F4\u9694, \u5355\u4F4D\u662F\u6BEB\u79D2 (\u9ED8\u8BA450\u6BEB\u79D2)</li><li>purger=on \u662F\u5426\u542F\u52A8purge\u8FDB\u7A0B</li></ul></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_cache_path /data/nginx/cache keys_zone=one:10m loader_threshold=300 loader_files=200;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>/root/cache\uFF1A\u5B9A\u4E49 proxy_cache \u751F\u6210\u6587\u4EF6\u7684\u6839\u8DEF\u5F84</p></li><li><p>levels\uFF1A\u9ED8\u8BA4\u6240\u6709\u7F13\u5B58\u6587\u4EF6\u90FD\u653E\u5728\u4E0A\u9762\u6307\u5B9A\u7684\u6839\u8DEF\u5F84\u4E2D\uFF0C\u4ECE\u800C\u53EF\u80FD\u5F71\u54CD\u7F13\u5B58\u7684\u6027\u80FD\u3002\u63A8\u8350\u6307\u5B9A\u4E3A 2 \u7EA7\u76EE\u5F55\u6765\u5B58\u50A8\u7F13\u5B58\u6587\u4EF6</p></li><li><p>key_zone\uFF1A\u8FD9\u4E2A\u7684\u503C\u662F\u5B57\u7B26\u4E32\uFF0C\u53EF\u4EE5\u968F\u610F\u5199\u3002\u7528\u4E8E\u5728\u5171\u4EAB\u5185\u5B58\u4E2D\u5B9A\u4E49\u4E00\u5757\u5B58\u50A8\u533A\u57DF\u6765\u5B58\u653E\u7F13\u5B58\u7684 key \u548C metadata\uFF08\u7C7B\u4F3C\u4E8E\u4F7F\u7528\u6B21\u6570\uFF09\uFF0C\u8FD9\u6837 nginx \u53EF\u4EE5\u5FEB\u901F\u5224\u65AD\u4E00\u4E2A request \u662F\u5426\u547D\u4E2D\u7F13\u5B58\u30021m \u53EF\u4EE5\u5B58\u50A8 8000 \u4E2Akey,10m\u53EF\u4EE5\u5B58\u572880000\u4E2Akey</p></li><li><p>max_size\uFF1A\u6700\u5927 cache \u7A7A\u95F4\u3002\u5982\u679C\u4E0D\u6307\u5B9A\uFF0C\u4F1A\u4F7F\u7528\u6389\u6240\u6709 disk space\u3002\u5F53\u8FBE\u5230 disk \u4E0A\u9650\u540E\uFF0C\u4F1A\u5220\u9664\u6700\u5C11\u4F7F\u7528\u7684 cache</p></li><li><p>inactive\uFF1A\u5185\u5B58\u4E2D\u7F13\u5B58\u7684\u8FC7\u671F\u68C0\u67E5\u5468\u671F\u3002\u793A\u4F8B\u914D\u7F6E\u4E2D\u5982\u679C 1h \u5185\u90FD\u6CA1\u6709\u88AB\u8BBF\u95EE\uFF0C\u5219\u4E0D\u8BBA\u72B6\u6001\u662F\u5426\u4E3A expired\uFF0C\u90FD\u4F1A\u6E05\u9664\u7F13\u5B58\u3002\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0Cinactive \u548C expired \u914D\u7F6E\u9879\u7684\u542B\u4E49\u662F\u4E0D\u540C\u7684\uFF0Cexpired \u53EA\u662F\u5224\u65AD\u8FC7\u671F\u65F6\u95F4\uFF0C\u4E0D\u4F1A\u5220\u9664\u7F13\u5B58\uFF1B\u800C inactive \u662F\u76F4\u63A5\u5220\u9664\u8FC7\u671F\u7F13\u5B58</p></li><li><p>use_temp_path\uFF1A\u5982\u679C\u4E3A off\uFF0C\u5219 nginx \u4F1A\u5C06\u7F13\u5B58\u6587\u4EF6\u76F4\u63A5\u5199\u5165\u6307\u5B9A\u7684 cache \u6587\u4EF6\u4E2D\uFF0C\u800C\u4E0D\u4F7F\u7528 temp_path \u6307\u5B9A\u7684\u4E34\u65F6\u5B58\u50A8\u8DEF\u5F84</p></li></ul><h3 id="proxy-cache" tabindex="-1"><a class="header-anchor" href="#proxy-cache" aria-hidden="true">#</a> proxy_cache</h3><p>proxy_cache zone | off\u3002\u9ED8\u8BA4\u662F\u5173\u95ED\u7684\uFF0C\u53EF\u4EE5\u7528\u5728http,server,location\u4E2D\u3002</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_cache</span> zzm_cache</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://zzm</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_cache_valid</span> <span class="token number">200</span> <span class="token number">304</span> <span class="token number">12h</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_cache_valid</span> any <span class="token number">10m</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_cache_key</span> <span class="token variable">$host</span><span class="token variable">$uri</span><span class="token variable">$is_args</span><span class="token variable">$args</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> Nginx-Cache <span class="token string">&quot;<span class="token variable">$upstream_cache_status</span>&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_next_upstream</span> error timeout invalid_header http_500 http_502 http_503 http_504</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>proxy_cache\uFF1A\u5BF9\u5E94 http \u6BB5\u7684 key_zone\uFF0C\u662F\u4F60\u5B9A\u4E49\u7684 proxy_cache \u6240\u4F7F\u7528\u7684\u5171\u4EAB\u7A7A\u95F4\u7684\u540D\u79F0\uFF0C\u6211\u57281.1\u4E2D\u5B9A\u4E49\u7684\u662Fzzm_cache\uFF0C\u6240\u4EE5\u5728\u8FD9\u91CC\u4E5F\u5199\u7684\u662Fzzm_cache\u3002</p></li><li><p>proxy_cache_key \u63A7\u5236\u7F13\u5B58KEY\u7684\u751F\u6210\u89C4\u5219</p></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_cache_key &quot;$host$request_uri$cookie_user&quot;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>proxy_cache_min_uses \u6307\u5B9A\u4E00\u4E2A\u8BF7\u6C42\u7684\u54CD\u5E94\u88AB\u7F13\u5B58\u524D\u7684\u6700\u5C0F\u8BBF\u95EE\u6B21\u6570</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_cache_min_uses 5;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>proxy_cache_methods \u6307\u5B9A\u53EA\u6709\u54EA\u4E9BHTTP\u8BF7\u6C42\u7C7B\u578B\u624D\u80FD\u88AB\u7F13\u5B58</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_cache_methods GET HEAD POST;    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>proxy_cache_valid\uFF1A\u5BF9\u6307\u5B9A\u7684 HTTP \u72B6\u6001\u8FDB\u884C\u7F13\u5B58\uFF0C\u5E76\u6307\u5B9A\u7F13\u5B58\u65F6\u95F4\u3002\u53EF\u4EE5\u81EA\u5B9A\u4E49\u5199\u5165\u591A\u4E2A\u914D\u7F6E\u9879\u3002\u8FD9\u91CC\u6211\u4EEC\u5BF9200\u548C304\u7684\u8FD4\u56DE\u7801\u7F13\u5B5812\u5C0F\u65F6\u3002\u5176\u4F59\u7684\u7F13\u5B5810\u5206\u949F</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_cache_valid 200 302 10m;
proxy_cache_valid 404      1m;   
proxy_cache_valid any 5m;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>proxy_cache_bypass \u6307\u5B9ANginx\u4F7F\u7528\u7F13\u5B58\u7684\u6761\u4EF6</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#\u8BE5\u6307\u4EE4\u7684\u6BCF\u4E2A\u53C2\u6570\u90FD\u6307\u5B9A\u4E86\u4E00\u4E2A\u6761\u4EF6\uFF0C\u53EA\u6709\u8BF7\u6C42\u6EE1\u8DB3\u5176\u4E2D\u7684\u4EFB\u4F55\u4E00\u4E2A\u6761\u4EF6\uFF0C\u5E76\u4E14\u53C2\u6570\u7684\u503C\u4E0D\u662F0\uFF0C\u5219Nginx\u4F1A\u628A\u8BF7\u6C42\u8F6C\u53D1\u5230\u540E\u7AEF\u7684\u670D\u52A1\u800C\u4E0D\u4F1A\u4F7F\u7528\u7F13\u5B58\u3002
proxy_cache_bypass $cookie_nocache $arg_nocache$arg_comment;   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>proxy_no_cache \u6307\u5B9A\u54EA\u4E9B\u8BF7\u6C42\u4E0D\u9700\u8981Nginx\u6765\u7F13\u5B58</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>proxy_no_cache $http_pragma $http_authorization;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>is_args:\u5982\u679C$args\u8BBE\u7F6E\uFF0C\u503C\u4E3A&quot;?&quot;\uFF0C\u5426\u5219\u4E3A&quot;&quot;</p></li><li><p>proxy_next_upstream \u5F53\u8BF7\u6C42\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\u6216\u8D85\u65F6\u65F6\uFF0C\u4F1A\u5C1D\u8BD5\u5230\u4E0B\u4E00\u53F0\u670D\u52A1\u5668</p></li></ul><h3 id="\u7F13\u5B58\u6269\u5C55" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u6269\u5C55" aria-hidden="true">#</a> \u7F13\u5B58\u6269\u5C55</h3><ul><li><p>rm \u7F13\u5B58\u76EE\u5F55\u6240\u6709\u6587\u4EF6</p></li><li><p>\u4F7F\u7528ngx_cache_purge</p></li></ul><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code> <span class="token directive"><span class="token keyword">location</span> ~ /purge(/.*)</span> <span class="token punctuation">{</span>
                <span class="token directive"><span class="token keyword">allow</span> all</span><span class="token punctuation">;</span> <span class="token comment">#127.0.0.1; \u53EA\u5141\u8BB8\u672C\u673A\u8BBF\u95EE</span>
                <span class="token directive"><span class="token keyword">deny</span> all</span><span class="token punctuation">;</span>  <span class="token comment">#\u7981\u6B62\u5176\u4ED6\u6240\u6709ip</span>
                <span class="token directive"><span class="token keyword">proxy_cache_purge</span> cache_one <span class="token variable">$host</span><span class="token variable">$1</span><span class="token variable">$is_args</span><span class="token variable">$args</span></span><span class="token punctuation">;</span>  <span class="token comment">#\u6E05\u7406\u7F13\u5B58</span>
                <span class="token directive"><span class="token keyword">access_log</span>  logs/cache.log cache</span><span class="token punctuation">;</span> <span class="token comment"># \u589E\u52A0\u6E05\u7406\u8F93\u51FA\u65E5\u5FD7</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code> <span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
        ...
        <span class="token directive"><span class="token keyword">proxy_cache_path</span> /data/nginx/cache levels=1:2 keys_zone=mycache:10m purger=on</span><span class="token punctuation">;</span>
    
        <span class="token directive"><span class="token keyword">map</span> <span class="token variable">$request_method</span> <span class="token variable">$purge_method</span></span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">PURGE</span> <span class="token number">1</span></span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">default</span> <span class="token number">0</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">listen</span>      <span class="token number">80</span></span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">server_name</span> www.example.com</span><span class="token punctuation">;</span>
    
                <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
                    <span class="token directive"><span class="token keyword">proxy_pass</span>        https://localhost:8002</span><span class="token punctuation">;</span>
                    <span class="token directive"><span class="token keyword">proxy_cache</span>       mycache</span><span class="token punctuation">;</span>
                    <span class="token directive"><span class="token keyword">proxy_cache_purge</span> <span class="token variable">$purge_method</span></span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    
        <span class="token directive"><span class="token keyword">geo</span> <span class="token variable">$purge_allowed</span></span> <span class="token punctuation">{</span>
           <span class="token directive"><span class="token keyword">default</span>         <span class="token number">0</span></span><span class="token punctuation">;</span>
           <span class="token directive"><span class="token keyword">10.0.0.1</span>        <span class="token number">1</span></span><span class="token punctuation">;</span>
           <span class="token directive"><span class="token keyword">192.168.0.0/24</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token directive"><span class="token keyword">map</span> <span class="token variable">$request_method</span> <span class="token variable">$purge_method</span></span> <span class="token punctuation">{</span>
               <span class="token directive"><span class="token keyword">PURGE</span>   <span class="token variable">$purge_allowed</span></span><span class="token punctuation">;</span>
               <span class="token directive"><span class="token keyword">default</span> <span class="token number">0</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u90E8\u5206\u9875\u9762\u4E0D\u7F13\u5B58 <img src="`+i+'" alt=""></li></ul><h3 id="\u7F13\u5B58\u547D\u4E2D\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#\u7F13\u5B58\u547D\u4E2D\u5206\u6790" aria-hidden="true">#</a> \u7F13\u5B58\u547D\u4E2D\u5206\u6790</h3><ul><li>\u901A\u8FC7\u8BBE\u7F6Eresponse\u7684\u5934\u4FE1\u606FNginx-Cache add_header Nging-Cache &quot;$upstream_cache_status&quot;; <img src="'+p+'" alt=""></li><li>\u901A\u8FC7\u8BBE\u7F6Elog_format,\u6253\u5370\u65E5\u5FD7\u5206\u6790 <img src="'+t+`" alt=""></li></ul><h3 id="\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u793A\u4F8B" aria-hidden="true">#</a> \u793A\u4F8B</h3><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">user</span>  www</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">8</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">65535</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">include</span>      mime.types</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">default_type</span>  application/octet-stream</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">charset</span> utf-8</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">log_format</span>  main  <span class="token string">&#39;<span class="token variable">$http_x_forwarded_for</span> <span class="token variable">$remote_addr</span> <span class="token variable">$remote_user</span> [<span class="token variable">$time_local]</span> &quot;<span class="token variable">$request</span>&quot; &#39;</span>
                      <span class="token string">&#39;<span class="token variable">$status</span> <span class="token variable">$body_bytes_sent</span> &quot;<span class="token variable">$http_referer</span>&quot; &#39;</span>
                      <span class="token string">&#39;&quot;<span class="token variable">$http_user_agent</span>&quot; &quot;<span class="token variable">$http_cookie</span>&quot; <span class="token variable">$host</span> <span class="token variable">$request_time</span>&#39;</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">sendfile</span>      <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">tcp_nopush</span>    <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">tcp_nodelay</span>    <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span></span><span class="token punctuation">;</span>

    <span class="token comment">#\u8981\u60F3\u5F00\u542Fnginx\u7684\u7F13\u5B58\u529F\u80FD\uFF0C\u9700\u8981\u6DFB\u52A0\u6B64\u5904\u7684\u4E24\u884C\u5185\u5BB9\uFF01</span>
    <span class="token comment">#\u8BBE\u7F6EWeb\u7F13\u5B58\u533A\u540D\u79F0\u4E3Acache_one,\u5185\u5B58\u7F13\u5B58\u7A7A\u95F4\u5927\u5C0F\u4E3A500M,\u7F13\u5B58\u7684\u6570\u636E\u8D85\u8FC71\u5929\u6CA1\u6709\u88AB\u8BBF\u95EE\u5C31\u81EA\u52A8\u6E05\u9664;\u8BBF\u95EE\u7684\u7F13\u5B58\u6570\u636E,\u786C\u76D8\u7F13\u5B58\u7A7A\u95F4\u5927\u5C0F\u4E3A30G</span>
\u3000<span class="token directive"><span class="token keyword">proxy_cache_path</span> /usr/local/nginx/proxy_cache_path levels=1:2 keys_zone=cache_one:500m inactive=1d max_size=30g</span><span class="token punctuation">;</span>


    <span class="token comment">#\u521B\u5EFA\u7F13\u5B58\u7684\u65F6\u5019\u53EF\u80FD\u751F\u6210\u4E00\u4E9B\u4E34\u65F6\u6587\u4EF6\u5B58\u653E\u7684\u4F4D\u7F6E</span>
\u3000<span class="token directive"><span class="token keyword">proxy_temp_path</span> /usr/local/nginx/proxy_temp_path</span><span class="token punctuation">;</span>


    <span class="token directive"><span class="token keyword">fastcgi_connect_timeout</span> <span class="token number">3000</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_send_timeout</span> <span class="token number">3000</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_read_timeout</span> <span class="token number">3000</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_buffer_size</span> <span class="token number">256k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_buffers</span> <span class="token number">8</span> <span class="token number">256k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_busy_buffers_size</span> <span class="token number">256k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_temp_file_write_size</span> <span class="token number">256k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">fastcgi_intercept_errors</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">client_header_timeout</span> <span class="token number">600s</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">client_body_timeout</span> <span class="token number">600s</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">100m</span></span><span class="token punctuation">;</span>             
    <span class="token directive"><span class="token keyword">client_body_buffer_size</span> <span class="token number">256k</span></span><span class="token punctuation">;</span>           

    <span class="token directive"><span class="token keyword">gzip</span>  <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_min_length</span>  <span class="token number">1k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_buffers</span>    <span class="token number">4</span> <span class="token number">16k</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_http_version</span> 1.1</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_comp_level</span> <span class="token number">9</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_types</span>      text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">gzip_vary</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">include</span> vhosts/*.conf</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35),o=[l];function r(d,u){return s(),a("div",null,o)}var k=n(c,[["render",r],["__file","nginx.html.vue"]]);export{k as default};
